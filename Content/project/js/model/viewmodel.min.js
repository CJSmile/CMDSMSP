function LoadingViewModel(){var n=this;n.loadingVisible=ko.observable(!1);n.closeOnOutsideClick=ko.observable(!1);n.showIndicator=ko.observable(!0);n.showPane=ko.observable(!0);n.shading=ko.observable(!0);n.position=ko.observable("");n.loadOptions={visible:n.loadingVisible,showIndicator:n.showIndicator,showPane:n.showPane,shading:n.shading,closeOnOutsideClick:n.closeOnOutsideClick,shadingColor:"rgba(0,0,0,0.4)",position:{of:n.position()},onShown:function(){},onHidden:function(){}};n.showLoadPanel=function(){n.loadingVisible(!0)}}function MenuViewModel(){var n=this;n.name=ko.observable("Monitor");n.monitor=ko.observable(!0);n.setup=ko.observable(!1);n.owner=ko.observable(!1);n.commission=ko.observable(!1);n.webreport=ko.observable(!1);n.summary=ko.observable(!1);n.egiftcard=ko.observable(!1);n.log=ko.observable(!1);n.marketingService=ko.observable(!1)}function CustomerViewModel(n){var t=this;isEmpty(n)?(t.customerId=ko.observable(""),t.firstName=ko.observable(""),t.lastName=ko.observable(""),t.flag=ko.observable(!1),t.email=ko.observable(""),t.isExternalLogIn=ko.observable(!1),t.isAccountant=ko.observable(!1)):ko.mapping.fromJSON(n,{},t)}function MonitorViewModel(n){var t=this,i,r,u;i=isFireFox()?new Date:getDateJs(moment(n).format(moment_date_format_mmddyyyy));t.dateBox=ko.observable({type:"date",pickerType:"calendar",value:i,displayFormat:"MM-dd-yyyy",onValueChanged:function(n){var i=moment(n.value).format(moment_date_format_mmddyyyy);t.selectDate(i)}});t.selectDate=ko.observable(moment(n).format(moment_date_format_mmddyyyy));t.domainId=ko.observable("");t.store=new DevExpress.data.ArrayStore({data:[],key:"domainId"});t.dxLookupDomain=ko.observable({dataSource:t.store,displayExpr:"domainDesc",valueExpr:"domainId",value:"",showPopupTitle:!1,showClearButton:!0,onValueChanged:function(n){var r=n.previousValue,i=n.value;t.domainId(i)}});t.data=ko.observableArray([]);t.dataModal=new DataMonitorViewModel;t.dataSelectRow=new DataMonitorViewModel;t.dataGridOptions=ko.observable({dataSource:t.data,showColumnLines:!0,showRowLines:!0,showBorders:!0,hoverStateEnabled:!0,columnChooser:{enabled:!0,mode:"select"},grouping:{contextMenuEnabled:!0,expandMode:"rowClick"},sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},groupPanel:{visible:!0},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{dataField:"shopName",caption:"Shop Name",alignment:"center",cssClass:"left",minWidth:"140px",cellTemplate:function(n,t){t.data.ticketStatus()=="V"?n.html("<p>"+t.data.shopName()+" <span class='badge badge-danger'> Void <\/span><\/p>"):n.html(t.data.shopName())}},{dataField:"shopTicket",caption:"ID",alignment:"center"},{dataField:"customerName",caption:"Customer Name",alignment:"center",cssClass:"left"},{dataField:"orderTypeName",caption:"Order Type",alignment:"center"},{dataField:"paymentType",caption:"Payment Type",alignment:"center"},{dataField:"grandTotal",caption:"Total",alignment:"center",cssClass:"right",format:"currency",precision:2},{dataField:"ticketDateTime",caption:"Time",alignment:"center",sortOrder:"desc",dataType:"date",format:"hh:mm aa",allowFiltering:!1},{dataField:"todayAsap",caption:"ASAP",alignment:"center"},{dataField:"send",caption:"Send",alignment:"center"},{dataField:"confirm",caption:"Confirm",alignment:"center"},{dataField:"ticketStatus",caption:"Status",alignment:"center",visible:!1},],onCellPrepared:function(n){var i=n.column,t=n.value,r="";(i.dataField==="send"||i.dataField==="confirm"||i.dataField==="todayAsap")&&(isEmpty(t)||(r=t==!0?"<span><i class='fa fa-check theme-true'><\/i><\/span>":t==!1?"<span><i class='fa fa-times theme-false'><\/i><\/span>":t.value,n.cellElement.html(r)))},onRowClick:function(n){t.messageAdjust("");var i=n.data,r=ko.mapping.toJSON(i);ko.mapping.fromJSON(r,{},t.dataModal);modalShow(cModalMonitor)},onToolbarPreparing:function(n){var t=n.component;n.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{icon:"fa fa-users",onClick:function(){vmViewIndex.isPopupVisible(!0)}}})},onSelectionChanged:function(n){ko.mapping.fromJS(n.selectedRowsData[0],{},t.dataSelectRow)}});r="Adjust Price";u="Adjust Tip";t.messageAdjust=ko.observable("");t.clickAdjustPrice=function(){t.messageAdjust(r)};t.clickAdjustTip=function(){t.messageAdjust(u)};t.getTicketStatus=function(){var i;if(t.dataModal.ticketId()>0&&(i=ko.utils.arrayFilter(t.data(),function(n){return n.ticketId()==t.dataModal.ticketId()&&n.domainId()==t.dataModal.domainId()}),i.length>0)){var r=_.first(i),u=moment(n).format(moment_date_format_mmddyyyy),f=moment(r.ticketDateTime()).format(moment_date_format_mmddyyyy);return moment(u).diff(f,"days")>0?r.ticketStatus():cShortStatusVoid}return null};t.clickVoidTicket=function(){swalMessage({msgType:"warning",msgTitle:"Do you want void transaction?"},function(){$("#"+cfrmMonitorVoidTicket).submit()})};t.tip=ko.observable(0).extend({numeric:2});t.blurTip=function(n,i){var r=$(i.target).val();r=$.isNumeric(r)?rountTwo(r):0;r<0&&(r=0);t.tip(r)};t.price=ko.observable(0).extend({numeric:2});t.blurPrice=function(n,i){var r=$(i.target).val();r=$.isNumeric(r)?rountTwo(r):0;r<0&&(r=0);t.price(r)}}function ShopOnlineViewModel(){var n=this;n.data=ko.observableArray([]);n.dataGridOptions=ko.observable({dataSource:n.data,width:"100%",paging:{pageSize:100},paginate:!1,showColumnLines:!0,showRowLines:!0,showBorders:!0,hoverStateEnabled:!0,sorting:{mode:"multiple"},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{dataField:"domainDesc",caption:"Name",width:200,alignment:"center",cssClass:"left",sortOrder:"asc"},{dataField:"online",caption:"Status",alignment:"center"},{dataField:"domainId",caption:"Reset",width:100,alignment:"center"},],onCellPrepared:function(n){var r=n.column,t=n.value,i="";r.dataField==="online"&&(isEmpty(t)||(i=t==!0?"<span><i class='fa fa-check theme-true'><\/i><\/span>":t==!1?"<span><i class='fa fa-times theme-false'><\/i><\/span>":t.value,n.cellElement.html(i)));r.dataField==="domainId"&&(isEmpty(t)||(i=t.length>0?"<span><button type='button' class='btn btn-light text-primary' value='RESET'>Reset<\/button><\/span>":t.value,n.cellElement.html(i)))},onCellClick:function(n){var t=n.data,i;n.rowType=="data"&&n.column.dataField=="domainId"&&(i={msgType:"warning",msgTitle:"Do you want reset data ["+t.domainDesc()+"] ?"},swalMessage(i,function(){getObjFormDomainFormAjax(cJsonResetDataSmileDining,t.domainId(),t.domainName())}))}});n.toastMessage=ko.observable("");n.toastVisible=ko.observable(!1);n.toast=ko.observable({message:n.toastMessage,minWidth:200,maxWidth:350,animation:{show:{type:"fade",from:0,to:1},hide:{type:"fade",from:1,to:0}},visible:n.toastVisible,displayTime:15e3,position:{my:"top",at:"right top",of:window,offset:"-180 20"},type:"error"})}function SetupViewModel(n){function i(n,t,i,r){var f=new ObjUrl(n),e=f.getUrlFromJson(),u;return isEmpty(t)||isEmpty(i)||(u=JSON.parse('{"domainValue" : "'+t+'", "domainId" : "'+i+'", "accountName" : "'+r+'"}')),getJsonFromAjax(e,!ajax_async,ajax_cache,ajax_type_post,u,ajax_timeout)}var t=this;t.data=ko.observableArray([]);t.dataModal=new DatSetupViewModel(n);t.dataSetUpUsaEpaySearchDateModal=new DataSetupUsaEpaySearchDateViewModel(n);t.dataGridOptions=ko.observable({dataSource:t.data,showColumnLines:!0,showRowLines:!0,showBorders:!0,hoverStateEnabled:!0,columnChooser:{enabled:!0,mode:"select"},grouping:{contextMenuEnabled:!0,expandMode:"rowClick"},sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},groupPanel:{visible:!0},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{dataField:"domainId",caption:"#",alignment:"center",cssClass:"left"},{dataField:"domainDesc",caption:"Shop Name",alignment:"center",cssClass:"left",sortOrder:"asc"},{dataField:"domainValue",caption:"Database",alignment:"center",cssClass:"left"},{dataField:"domainName",caption:"Domain Name",alignment:"center",cssClass:"left"},{dataField:"active",caption:"",width:80,alignment:"center",allowFiltering:!1}],onCellPrepared:function(n){var i=n.column,r=n.value,t="";i.dataField==="active"&&(isEmpty(r)||(t="<span><i class='fa fa-list-alt'><\/i><\/span>",n.cellElement.html(t)))},onCellClick:function(n){var e=n.data,it,v,a,w,b,rt,ut,ft,et,ot,st,k,d,g,y,s,h,c,l,p,nt,tt;if(n.rowType=="data"&&n.column.dataField=="active")t.dataSetUpUsaEpaySearchDateModal.data([]),refreshGrid(cGridSetUpUsaEpaySearchDate),t.dataSetUpUsaEpaySearchDateModal.domainId(e.domainId()),modalShow(cModalSetupUsaEpaySearchDate);else if(!isEmpty(e))if(isLoading(!0),t.dataModal.accountId(e.deliverect_AccountId()==null?"":e.deliverect_AccountId()),t.dataModal.accountName(""),t.dataModal.accountId()!=""&&t.dataAllAccount().length>0&&isProduction(e.domainId())&&(it=ko.utils.arrayFilter(t.dataAllAccount(),function(n){return n.accountId()==t.dataModal.accountId()}),t.dataModal.accountName(_.first(it).accountName())),v=i(cJsonGetDataDomainValue,e.domainValue(),e.domainId(),t.dataModal.accountName()),v!=""&&v!=null){var f=JSON.parse(v),u=e,ht=f.creditCardFee,ct=f.deliveryCharge,lt=f.serviceFee,at=f.marketingServiceFee,r=ko.mapping.toJS(f.globalConfig),o=ko.mapping.toJS(f.globalConfigContactless);t.dataModal.action(cStatusUpdate);t.dataModal.domainId(u.domainId());t.dataModal.domainName(u.domainName());t.dataModal.domainValue(u.domainValue());t.dataModal.domainNameTemplate(u.domainNameTemplate());t.dataModal.active(u.active());t.dataModal.sourceKey(u.sourceKey());t.dataModal.pin(u.pin());t.dataModal.productId(u.productId());t.dataModal.currentProductId(u.productId());t.dataModal.apiKey(u.apiKey());t.dataModal.marketingKey(u.marketingKey());const n=u.productId().split(","),i=["1","2","3","4","5"];t.dataModal.arrProduct.removeAll();t.dataModal.selectCheckBoxProduct.removeAll();i.length>0&&_.forEach(i,function(n){t.dataModal.arrProduct.push(n)});n.length>0&&_.forEach(n,function(n){t.dataModal.selectCheckBoxProduct.push(n)});t.dataModal.selectCheckBoxProduct().includes(products.cSmileContactless)?(t.dataModal.showPaymentContactless(!0),t.dataModal.showSmileContactless(!0)):(t.dataModal.showPaymentContactless(!1),t.dataModal.showSmileContactless(!1));t.dataModal.selectCheckBoxProduct().includes(products.cSmileDining)?t.dataModal.showSmileDining(!0):t.dataModal.showSmileDining(!1);t.dataModal.selectCheckBoxProduct().includes(products.cSmileThirdPartyIntegrations)&&t.dataModal.active()?(t.dataModal.showThirdPartyIntegrations(!0),$(".slickSetup .slick-dots li:nth-of-type(4)").removeClass("d-none")):(t.dataModal.showThirdPartyIntegrations(!1),$(".slickSetup .slick-dots li:nth-of-type(4)").addClass("d-none"));t.dataModal.listLocation([]);ko.utils.arrayForEach(f.listLocation,function(n){t.dataModal.listLocation.push({locationId:ko.observable(n.locationId),locationName:ko.observable(n.locationName)})});a=u.deliverect_LocationId()==null?"":u.deliverect_LocationId();t.dataModal.locationSelect(a==""?"0":a);w=ko.utils.arrayFilter(f.listLocation,function(n){return n.locationId==a});w.length>0?t.dataModal.locationId(ko.toJSON(_.first(w))):t.dataModal.locationId("");isProduction(e.domainId())||t.dataModal.accountName(f.accountName);t.dataModal.dispatchStore([]);b=[];ko.utils.arrayForEach(f.listDispatch,function(n){t.dataModal.dispatchStore.push({dispatchId:ko.observable(n.dispatchId),dispatchName:ko.observable(n.dispatchName)});b.push(n.dispatchId)});t.dataModal.currentDispatchIdStore("");t.dataModal.currentDispatchIdStore(ko.toJSON(b));t.dataModal.initLocationId("");t.dataModal.initLocationId(a);t.dataModal.initListDispatch([]);t.dataModal.listDispatch([]);const it=u.thirdPartyId()==null?"":u.thirdPartyId().split(",");it.length>0&&(_.forEach(it,function(n){ko.utils.arrayForEach(f.listDispatch,function(i){i.thirdPartyId==n&&t.dataModal.initListDispatch.push(i.dispatchId)})}),t.dataModal.listDispatch(t.dataModal.initListDispatch()));t.dataModal.captchaEnable(convertStrToBool(filterGlobalConfig(r,"captcha-enable")));t.dataModal.captchaKeepAlive(convertStrToBool(filterGlobalConfig(r,"captcha-keep-alive")));rt=filterGlobalConfig(r,gcShopUseTemplate);rt=="0"?t.dataModal.useTemplate(!1):t.dataModal.useTemplate(!0);t.dataModal.domainNameTemplateUrl(filterGlobalConfig(r,gcShopUseTemplateUrl));ut=filterGlobalConfig(r,gcShopUsePos);ut=="0"?t.dataModal.usePos(!1):t.dataModal.usePos(!0);ft=filterGlobalConfig(r,"shop-signalr");ft=="0"?t.dataModal.signalR(!1):t.dataModal.signalR(!0);et=filterGlobalConfig(r,"required-estimate-time");et=="1"?t.dataModal.estimateTime(!0):t.dataModal.estimateTime(!1);ot=filterGlobalConfig(r,gcCalTax);ot=="1"?t.dataModal.isCalTax(!0):t.dataModal.isCalTax(!1);st=filterGlobalConfig(o,gcCalTax);st=="1"?t.dataModal.isCalTaxContactless(!0):t.dataModal.isCalTaxContactless(!1);t.dataModal.shopName(filterGlobalConfig(r,gcShopName));t.dataModal.shopAddress(filterGlobalConfig(r,gcShopStreet));t.dataModal.shopCity(filterGlobalConfig(r,gcShopCity));t.dataModal.shopState(filterGlobalConfig(r,gcShopState));t.dataModal.shopPostal(filterGlobalConfig(r,gcShopPostal));t.dataModal.shopPhone(filterGlobalConfig(r,gcShopPhone));t.dataModal.shopFax(filterGlobalConfig(r,gcShopFax));t.dataModal.shopEmail(filterGlobalConfig(r,gcShopEmail));t.dataModal.shopEmailGiftCard(filterGlobalConfig(r,gcShopEmailGiftCard));t.dataModal.lat(filterGlobalConfig(r,gcShopMapLat));t.dataModal.lng(filterGlobalConfig(r,gcShopMapLng));k=filterGlobalConfig(r,gcShopTimeZoneCode);t.dataModal.dxLookuptimeZoneCode({value:k});t.dataModal.timeZoneCode(k);t.dataModal.timePickupStart(filterGlobalConfig(r,gcTimePickupStart));t.dataModal.timePickupEnd(filterGlobalConfig(r,gcTimePickupEnd));t.dataModal.timeDeliveryStart(filterGlobalConfig(r,gcTimeDeliveryStart));t.dataModal.timeDeliveryEnd(filterGlobalConfig(r,gcTimeDeliveryEnd));t.dataModal.shippingType(filterGlobalConfig(r,gcShippingType));t.dataModal.menuHourTimeStart(filterGlobalConfig(r,gcTimeMenuInit));d=filterGlobalConfig(r,gcTimeMenuCustomDay);g=filterGlobalConfig(r,gcTimeMenuCustomHours);t.dataModal.isCustomTimeMenu(t.dataModal.menuHourTimeStart()=="CUSTOM"?!0:!1);d==""||g==""?t.dataModal.isShowCustomTimeMenu(!1):(t.dataModal.isShowCustomTimeMenu(!0),t.dataModal.customDay(d),t.dataModal.customHours(g));t.dataModal.creditCardFee(ht);t.dataModal.deliveryChargeTax(ct);t.dataModal.serviceFee(lt);t.dataModal.marketingServiceFee(at);filterGlobalConfig(r,"fee-credit-and-marketing")=="1"?t.dataModal.feeCreditAndMarketing(!0):t.dataModal.feeCreditAndMarketing(!1);t.dataModal.minimumOrder(parseFloat(filterGlobalConfig(r,gcCalminumumOrder)));y=filterGlobalConfig(r,gcCalminimumOrderForPickup);t.dataModal.minimumOrderForPickup(y!=""?parseFloat(y):0);y==""?t.dataModal.showminimumOrderForPickup(!1):t.dataModal.showminimumOrderForPickup(!0);filterGlobalConfig(r,gcShopDeliveryTax)=="1"?t.dataModal.calDeliveryTax(!0):t.dataModal.calDeliveryTax(!1);t.dataModal.commissionRule(filterGlobalConfig(r,gcRuleCommission));filterGlobalConfig(r,gcShopStatus)=="OPEN"?t.dataModal.status(!0):t.dataModal.status(!1);t.dataModal.closeReson(filterGlobalConfig(r,gcShopCloseReason));s=filterGlobalConfig(r,gcShopCloseStartDate);s.trim().length>0&&(s=moment(s).format(moment_date_format_mmddyyyy));t.dataModal.closeStartDate(s);t.dataModal.dateBoxCloseStartDate({value:s});h=filterGlobalConfig(r,gcShopCloseEndDate);h.trim().length>0&&(h=moment(h).format(moment_date_format_mmddyyyy));t.dataModal.closeEndDate(h);t.dataModal.dateBoxCloseEndDate({value:h});filterGlobalConfig(o,gcShopStatus)=="OPEN"?t.dataModal.statusContactless(!0):t.dataModal.statusContactless(!1);t.dataModal.closeResonContactless(filterGlobalConfig(o,gcShopCloseReason));c=filterGlobalConfig(o,gcShopCloseStartDate);c.trim().length>0&&(c=moment(c).format(moment_date_format_mmddyyyy));t.dataModal.closeStartDateContactless(c);t.dataModal.dateBoxCloseStartDateContactless({value:c});l=filterGlobalConfig(o,gcShopCloseEndDate);l.trim().length>0&&(l=moment(l).format(moment_date_format_mmddyyyy));t.dataModal.closeEndDateContactless(l);t.dataModal.dateBoxCloseEndDateContactless({value:l});filterGlobalConfig(r,"pay-by-cash-pickup")=="1"?t.dataModal.pickupPayCash(!0):t.dataModal.pickupPayCash(!1);filterGlobalConfig(r,"pay-by-credit-pickup")=="1"?t.dataModal.pickupPayCredit(!0):t.dataModal.pickupPayCredit(!1);filterGlobalConfig(r,"pay-by-cash-delivery")=="1"?t.dataModal.deliveryPayCash(!0):t.dataModal.deliveryPayCash(!1);filterGlobalConfig(r,"pay-by-credit-delivery")=="1"?t.dataModal.deliveryPayCredit(!0):t.dataModal.deliveryPayCredit(!1);filterGlobalConfig(r,"deliverect-autosync-product")=="1"?t.dataModal.autoSyncProduct(!0):t.dataModal.autoSyncProduct(!1);filterGlobalConfig(r,"dispatch-web")=="1"?t.dataModal.webDispatch(!0):filterGlobalConfig(r,"dispatch-web")=="0"?t.dataModal.webDispatch(!1):t.dataModal.webDispatch(null);p=filterGlobalConfig(r,"dispatch-type");p=="1"||p==""?t.dataModal.dispatchType("1"):p=="2"&&t.dataModal.dispatchType("2");nt=filterGlobalConfig(o,"contactless-payment-type");nt==""?t.dataModal.contactlessPaymentType(contactlessPaymentType.cFastService):t.dataModal.contactlessPaymentType(nt);t.dataModal.statementType(filterGlobalConfig(r,gcCalStatement));t.dataModal.mapCode(filterGlobalConfig(r,gcShopMapCode));t.dataModal.tipAuto(filterGlobalConfig(r,"tip-auto"));t.dataModal.tipGuide(filterGlobalConfig(r,"tip-guide"));tt=filterGlobalConfig(r,"dispatch-service-charge");t.dataModal.dispatchServiceCharge(isEmpty(tt)?0:parseFloat(tt));modalShow(cModalSetup);$(".slickSetup").slick("setPosition");setMaskPhone();isLoading(!1)}else swal(cSwal_Alert_Error,cError_GetDataDomainValue_Fail,cSwal_Icon_Error),isLoading(!1)},onToolbarPreparing:function(n){n.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{icon:"fa fa-plus",onClick:function(){resetSetupViewModel();modalShow(cModalSetup);$(".slickSetup").slick("setPosition")}}},{location:"after",widget:"dxButton",options:{icon:"fa fa-cogs",onClick:function(){modalShow(cModalSettingAllDomain)}}})}});t.searchAddress=function(){$(cfrmSetUpDomain_ShopAddress).trigger("geocode")};t.dataAllAccount=ko.observableArray([]);t.showLoading=ko.observable(!1)}function OwnerViewModel(){var n=this,t;n.data=ko.observableArray([]);n.dataModal=new DataOwnerViewModel;n.dataGridOptions=ko.observable({onInitialized:function(n){t=n.component},dataSource:n.data,showColumnLines:!0,showRowLines:!0,showBorders:!0,hoverStateEnabled:!0,columnChooser:{enabled:!0,mode:"select"},grouping:{contextMenuEnabled:!0,expandMode:"rowClick"},sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},groupPanel:{visible:!0},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{caption:"#",width:80,alignment:"center",cellTemplate:function(n,i){n.text(t.pageIndex()*t.pageSize()+i.rowIndex+1)}},{dataField:"ownerId",caption:"ID",alignment:"center",width:"120px"},{dataField:"domainId",caption:"Shop ID",alignment:"center",width:"120px"},{dataField:"domainDesc",caption:"Shop Name",alignment:"center",cssClass:"left",sortOrder:"asc"},{dataField:"email",caption:"Email",alignment:"center",cssClass:"left"},{dataField:"firstName",caption:"First Name",alignment:"center",cssClass:"left"},{dataField:"lastName",caption:"Last Name",alignment:"center",cssClass:"left"},],onRowClick:function(t){var i=t.data;n.dataModal.action(cStatusUpdate);n.dataModal.customerId(i.customerId());n.dataModal.ownerId(i.ownerId());n.dataModal.ownerPhone(i.ownerPhone());n.dataModal.email(i.email());n.dataModal.firstName(i.firstName());n.dataModal.lastName(i.lastName());n.dataModal.domainId(i.domainId());n.dataModal.password("");n.dataModal.confirmPassword("");n.dataModal.showPassword(!1);n.dataModal.domainDesc(i.domainDesc());n.dataModal.dxLookupDomain({value:i.domainId()});modalShow(cModalOwner)},onToolbarPreparing:function(n){n.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{icon:"fa fa-plus",onClick:function(){resetOwnerViewModel();modalShow(cModalOwner)}}})}})}function SettingViewModel(){var n=this;n.dataModalChangePassword=new DataChangePasswordViewModel;n.dataModalCreateAccount=new DataCreateAccountViewModel}function SettingAllDomainViewModel(){var n=this;n.clickResizeImage=function(){ResizeImage(!1)};n.clickCreateIconImage=function(){createIconImage()}}function WebReportViewModel(){var n=this;const t="chevrondown",r="chevronnext",i="Collapse All",u="Expand All";n.dataCustomer=ko.observableArray([]);n.dataUser=ko.observableArray([]);n.dataRole=ko.observableArray([]);n.dataMenu=ko.observableArray([]);n.dataGroupMenu=ko.observableArray([]);n.dataRoleMenuMap=ko.observableArray([]);n.dataUserRoleMap=ko.observableArray([]);n.dataUserModal=new DataUserViewModel;n.dataUserRoleMapModal=new DataUserRoleMapModel;n.dataRoleMenuModal=new DataRoleMenuMapModel;n.dataGridRoleMenuMapExpanded=ko.observable(!0);n.dataGridRoleMenuMapExpandButtonIcon=ko.observable(t);n.dataGridRoleMenuMapExpandButtonHint=ko.observable(i);n.dataGridRoleMenuMapExpanded.subscribe(function(f){n.dataGridRoleMenuMapExpandButtonIcon(f?t:r);n.dataGridRoleMenuMapExpandButtonHint(f?i:u)});n.rdoRoleSelectInRoleMenuMap=ko.observable(null);n.dataGridRoleMenuMap=ko.observable({dataSource:n.dataRoleMenuMap,showColumnLines:!0,showRowLines:!0,showBorders:!0,hoverStateEnabled:!0,columnChooser:{enabled:!0,mode:"select"},grouping:{autoExpandAll:n.dataGridRoleMenuMapExpanded,expandMode:"rowClick"},sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{dataField:"shopName",caption:"Shop Name",alignment:"center",width:"120px",groupIndex:0,sortOrder:"asc"},{dataField:"roleName",caption:"Role",alignment:"center",width:"120px"},{dataField:"menuName",caption:"Menu",alignment:"center"},],onRowClick:function(t){var i=t.data,r;n.dataRoleMenuModal.action(cStatusUpdate);n.dataRoleMenuModal.roleMenuMapId(i.roleMenuMapId());n.dataRoleMenuModal.customerId(i.customerId());n.dataRoleMenuModal.roleMenuMap([]);n.rdoRoleSelectInRoleMenuMap(i.roleId());n.dataRoleMenuModal.dxLookupCustomer({value:i.customerId()});r=ko.utils.arrayFilter(n.dataRoleMenuMap(),function(n){return n.customerId()==i.customerId()});ko.utils.arrayForEach(n.dataRole(),function(t){var u=ko.utils.arrayFilter(r,function(n){return t.roleId()==n.roleId()}),i=[];ko.utils.arrayForEach(u,function(n){i.push({id:n.menuId(),name:n.menuName()})});n.dataRoleMenuModal.roleMenuMap.push(new ChildrenDataRoleMenuMapModel(t.roleId(),t.roleName(),i))});modalShow(cModalWrRoleMenuMap)},onToolbarPreparing:function(t){var i=t.component;t.toolbarOptions.items.unshift({location:"before",widget:"dxSelectBox",options:{width:200,items:[{value:"shopName",text:"Grouping by Shop Name"},{value:"roleName",text:"Grouping by Role"}],displayExpr:"text",valueExpr:"value",value:"shopName",onValueChanged:function(n){i.clearGrouping();i.columnOption(n.value,"groupIndex",0)}}},{location:"before",widget:"dxButton",options:{hint:n.dataGridRoleMenuMapExpandButtonHint,icon:n.dataGridRoleMenuMapExpandButtonIcon,onClick:function(){n.dataGridRoleMenuMapExpanded(!n.dataGridRoleMenuMapExpanded())}}},{location:"after",widget:"dxButton",options:{icon:"fa fa-plus",onClick:function(){resetWrRoleMenuViewModel();modalShow(cModalWrRoleMenuMap)}}})}});n.dataGridUser=ko.observable({onInitialized:function(n){dataGrid=n.component},dataSource:n.dataUser,showColumnLines:!0,showRowLines:!0,showBorders:!0,hoverStateEnabled:!0,columnChooser:{enabled:!0,mode:"select"},grouping:{contextMenuEnabled:!0,expandMode:"rowClick"},sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},groupPanel:{visible:!0},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{caption:"#",width:80,alignment:"center",cellTemplate:function(n,t){n.text(dataGrid.pageIndex()*dataGrid.pageSize()+t.rowIndex+1)}},{dataField:"email",caption:"Email",alignment:"center",width:"150px"},{dataField:"firstName",caption:"First Name",alignment:"center",cssClass:"left",sortOrder:"asc"},{dataField:"lastName",caption:"Last Name",alignment:"center",cssClass:"left"},{dataField:"active",caption:"",alignment:"center",width:"80px"},],onRowClick:function(t){var i=t.data;n.dataUserModal.action(cStatusUpdate);n.dataUserModal.userId(i.userId());n.dataUserModal.firstName(i.firstName());n.dataUserModal.lastName(i.lastName());n.dataUserModal.email(i.email());n.dataUserModal.phone(i.phone());n.dataUserModal.active(i.active());modalShow(cModalWrUser);setMaskPhone()},onToolbarPreparing:function(n){n.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{icon:"fa fa-plus",onClick:function(){resetWrUserViewModel();modalShow(cModalWrUser)}}})},onCellPrepared:function(n){var r=n.column,t=n.value,i="";r.dataField==="active"&&(isEmpty(t)||(i=t==!0?"<span><i class='fa fa-check theme-true'><\/i><\/span>":t==!1?"<span><i class='fa fa-times theme-false'><\/i><\/span>":t.value,n.cellElement.html(i)))}});n.dataGridUserRoleMapExpanded=ko.observable(!0);n.dataGridUserRoleMapExpandButtonIcon=ko.observable(t);n.dataGridUserRoleMapExpandButtonHint=ko.observable(i);n.dataGridUserRoleMapExpanded.subscribe(function(f){n.dataGridUserRoleMapExpandButtonIcon(f?t:r);n.dataGridUserRoleMapExpandButtonHint(f?i:u)});n.dataGridUserRoleMap=ko.observable({dataSource:n.dataUserRoleMap,showColumnLines:!0,showRowLines:!0,showBorders:!0,hoverStateEnabled:!0,columnChooser:{enabled:!0,mode:"select"},grouping:{autoExpandAll:n.dataGridUserRoleMapExpanded,expandMode:"rowClick"},sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{dataField:"shopName",caption:"Shop Name",alignment:"center",width:"120px",groupIndex:0,sortOrder:"asc"},{dataField:"roleName",caption:"Role",alignment:"center",width:"120px"},{dataField:"email",caption:"Email",alignment:"center"},{dataField:"firstName",caption:"First Name",alignment:"center",cssClass:"left"},{dataField:"lastName",caption:"Last Name",alignment:"center",cssClass:"left"},{dataField:"active",caption:"Active",alignment:"center"},],onRowClick:function(t){var i=t.data;n.dataUserRoleMapModal.userRoleMapId(i.userRoleMapId());n.dataUserRoleMapModal.dxLookupCustomer({value:i.customerId()});n.dataUserRoleMapModal.dxLookupUser({value:i.userId()});n.dataUserRoleMapModal.dxLookupRole({value:i.roleId()});n.dataUserRoleMapModal.action(cStatusUpdate);modalShow(cModalWrUserRoleMap)},onToolbarPreparing:function(t){var i=t.component;t.toolbarOptions.items.unshift({location:"before",widget:"dxSelectBox",options:{width:200,items:[{value:"shopName",text:"Grouping by Shop Name"},{value:"roleName",text:"Grouping by Role"},{value:"email",text:"Grouping by Email"}],displayExpr:"text",valueExpr:"value",value:"shopName",onValueChanged:function(n){i.clearGrouping();i.columnOption(n.value,"groupIndex",0)}}},{location:"before",widget:"dxButton",options:{hint:n.dataGridUserRoleMapExpandButtonHint,icon:n.dataGridUserRoleMapExpandButtonIcon,onClick:function(){n.dataGridUserRoleMapExpanded(!n.dataGridUserRoleMapExpanded())}}},{location:"after",widget:"dxButton",options:{icon:"fa fa-plus",onClick:function(){resetWrUserRoleMapViewModel();modalShow(cModalWrUserRoleMap)}}})},onCellPrepared:function(n){var r=n.column,t=n.value,i="";r.dataField==="active"&&(isEmpty(t)||(i=t==!0?"<span><i class='fa fa-check theme-true'><\/i><\/span>":t==!1?"<span><i class='fa fa-times theme-false'><\/i><\/span>":t.value,n.cellElement.html(i)))}})}function LogViewModel(n){var t=this,u,i,r;t.domainId=ko.observable(null);t.data=ko.observableArray([]);t.store=new DevExpress.data.ArrayStore({data:[],key:"domainId"});t.domainName=ko.observable();i=new Date;r=new Date(i.getFullYear(),i.getMonth(),1);t.selectTimeMenu=ko.observable("Month");t.currentDate=ko.observable(moment(n).format("MM/DD/YYYY"));t.firstDayofMonth=moment(r).format("L");t.valueStartMonth=ko.observable(t.firstDayofMonth);t.valueStartDate=ko.observable(t.currentDate());t.valueEndDate=ko.observable(t.currentDate());t.computeMinEndDate=ko.pureComputed(function(){return t.valueStartDate()==""||isEmpty(t.valueStartDate())?t.currentDate():t.valueStartDate()});t.dateMax=moment(t.valueStartDate()).add(29,"day").format(moment_date_format_mmddyyyy);t.computeMaxEndDate=ko.pureComputed(function(){return t.dateMax=moment(t.valueStartDate()).add(29,"day").format(moment_date_format_mmddyyyy)});t.computeFileName=ko.pureComputed(function(){return t.domainName()==""||isEmpty(t.domainName())?"":t.domainName()});t.dateBoxMonth=ko.observable({type:"date",width:250,value:t.valueStartMonth(),displayFormat:"monthAndYear",minZoomLevel:"century",maxZoomLevel:"year",onValueChanged:function(n){var i=moment(n.value).format("L");i=="Invalid date"?t.valueStartMonth(""):t.valueStartMonth(i)}});t.dateBoxStartDate=ko.observable({type:"date",pickerType:"calendar",width:100,value:t.valueStartDate(),max:t.dateMax,displayFormat:"MM-dd-yyyy",onValueChanged:function(n){var i=moment(n.value).format("L");i=="Invalid date"?t.valueStartDate(""):(t.valueStartDate(i),t.dateMax=moment(t.valueStartDate()).add(29,"day").format(moment_date_format_mmddyyyy))}});t.dateBoxEndDate=ko.observable({type:"date",pickerType:"calendar",width:100,value:t.valueEndDate(),min:t.computeMinEndDate,max:t.computeMaxEndDate,displayFormat:"MM-dd-yyyy",onValueChanged:function(n){var i=moment(n.value).format("L");t.valueEndDate(i);i=="Invalid date"?t.valueEndDate(""):t.valueEndDate(i)}});t.radioItem=ko.observableArray([{id:"Month",text:"Month"},{id:"Day",text:"Day"}]);t.dxRadioFilter=ko.observable({dataSource:t.radioItem,displayExpr:"text",valueExpr:"id",value:t.radioItem()[0].id,layout:"horizontal",onValueChanged:function(n){var i=n.value;t.selectTimeMenu(i)}});t.dxLookupDomain=ko.observable({dataSource:t.store,displayExpr:"domainDesc",valueExpr:"domainId",value:"",showPopupTitle:!1,showClearButton:!0,width:320,onValueChanged:function(n){t.domainId(n.value)}});t.dataGridLogStore=ko.observable({dataSource:t.data,onInitialized:function(n){u=n.component},showBorders:!0,showColumnHeader:!1,showColumnLines:!0,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,filterRow:{visible:!0},columnChooser:{enabled:!0,mode:"select"},"export":{enabled:!0,fileName:t.computeFileName,allowExportSelectedData:!1},columns:[{dataField:"logID",caption:"LogID",alignment:"center",cssClass:"left",width:"70px"},{dataField:"customerID",caption:"CustomerID",alignment:"center",cssClass:"left"},{dataField:"email",caption:"Email",alignment:"center",cssClass:"left"},{dataField:"site",caption:"Site",alignment:"center",cssClass:"left"},{dataField:"domainID",caption:"DomainID",alignment:"center",cssClass:"left"},{dataField:"property",caption:"Property",alignment:"center",cssClass:"left",width:"300px"},{dataField:"before",caption:"Before",alignment:"center",cssClass:"left",width:"300px"},{dataField:"after",caption:"After",alignment:"center",cssClass:"left",width:"300px"},{dataField:"status",caption:"Status",alignment:"center",cssClass:"left"},{dataField:"menu",caption:"Menu",alignment:"center",cssClass:"left"},{dataField:"createDate",caption:"CreateDate",alignment:"center",cssClass:"left"},],paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},loadPanel:{enabled:!0,showPane:!1,text:""}})}function SummaryViewModel(){function i(n,t){var r=new ObjUrl(n),u=r.getUrlFromJson(),i;isEmpty(t)||(i=JSON.parse('{"time" : "'+t+'"}'));$.ajax({url:u,async:ajax_async,cache:ajax_cache,type:ajax_type_post,data:i,timeout:ajax_timeout}).done(function(n){n.status?(summary=n.obj,ko.mapping.fromJSON(summary,{},vmViewIndex.summary.data)):(swal(cSwal_Alert_Error,n.message,cSwal_Icon_Error),vmViewIndex.summary.data=null);refreshGrid("gridSummary");loadingShimmer(!1,cGridSummary)}).fail(function(n){vmViewIndex.summary.data=null;swal(cSwal_Alert_Error,n.message,cSwal_Icon_Error);loadingShimmer(!1,cGridSummary)})}var n=this,t;n.data=ko.observableArray([]);n.showLoading=ko.observable(!1);n.dataGridOptions=ko.observable({onInitialized:function(n){t=n.component},dataSource:n.data,showColumnLines:!0,showRowLines:!0,showBorders:!0,hoverStateEnabled:!0,columnChooser:{enabled:!0,mode:"select"},grouping:{contextMenuEnabled:!0,expandMode:"rowClick"},sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},groupPanel:{visible:!0},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{dataField:"",caption:"#",width:80,alignment:"center",cellTemplate:function(n,i){n.text(t.pageIndex()*t.pageSize()+i.rowIndex+1)}},{dataField:"id",caption:"Shop ID",alignment:"center",width:"120px"},{dataField:"name",caption:"Shop Name",alignment:"center",cssClass:"left",sortOrder:"asc"},{dataField:"count",caption:"Tx Smile Dining",alignment:"center",cssClass:"center"},{dataField:"sum",caption:"Total Smile Dining",alignment:"center",cssClass:"right",format:"currency",precision:2},{dataField:"countTicketContactless",caption:"Tx Smile On Table",alignment:"center",cssClass:"center"},{dataField:"sumTotalContactless",caption:"Total Smile On Table",alignment:"center",cssClass:"right",format:"currency",precision:2},],"export":{enabled:!0,fileName:"Summary",allowExportSelectedData:!1},summary:{totalItems:[{column:"count",summaryType:"sum"},{column:"sum",summaryType:"sum",valueFormat:"currency"},{column:"countTicketContactless",summaryType:"sum"},{column:"sumTotalContactless",summaryType:"sum",valueFormat:"currency"}]},onRowPrepared:function(n){n.rowElement.addClass("datagrid-summary-state-hover")},onToolbarPreparing:function(n){n.toolbarOptions.items.unshift({location:"after",widget:"dxDateBox",options:{acceptCustomValue:!1,format:"date",width:170,value:new Date,displayFormat:"monthAndYear",maxZoomLevel:"year",minZoomLevel:"century",onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})},onValueChanged:function(n){loadingShimmer(!0,cGridSummary);i(cfrmSummaryGetData,moment(n.value).format("L"))}}})}})}function MarketingServiceViewModel(){function i(n,t){var r=new ObjUrl(n),u=r.getUrlFromJson(),i;isEmpty(t)||(i=JSON.parse('{"date" : "'+t+'"}'));$.ajax({url:u,async:ajax_async,cache:ajax_cache,type:ajax_type_post,data:i,timeout:ajax_timeout}).done(function(n){n.status&&(marketing=n.obj,ko.mapping.fromJSON(marketing.Result,{},vmViewIndex.marketingService.data));refreshGrid("gridMarketing");loadingShimmer(!1,cGridMarketing)}).fail(function(){vmViewIndex.marketingService.data=null;loadingShimmer(!1,cGridMarketing)})}var n=this,t;n.data=ko.observableArray([]);n.showLoading=ko.observable(!1);n.dataGridOptions=ko.observable({onInitialized:function(n){t=n.component},dataSource:n.data,showColumnLines:!0,showRowLines:!0,showBorders:!0,hoverStateEnabled:!0,columnChooser:{enabled:!0,mode:"select"},grouping:{contextMenuEnabled:!0,expandMode:"rowClick"},sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},groupPanel:{visible:!0},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{dataField:"",caption:"#",width:80,alignment:"center",cellTemplate:function(n,i){n.text(t.pageIndex()*t.pageSize()+i.rowIndex+1)}},{dataField:"id",caption:"Shop ID",alignment:"center",width:"120px"},{dataField:"name",caption:"Shop Name",alignment:"center",cssClass:"left",sortOrder:"asc"},{dataField:"count",caption:"Count",alignment:"center",cssClass:"center"},{dataField:"totalCredit",caption:"Total Credit",alignment:"center",cssClass:"right",format:"currency",precision:2},{dataField:"marketingFee",caption:"Marketing Service Fee",alignment:"center",cssClass:"right",format:"currency",precision:2},{dataField:"creditCardFee",caption:"Total CC Fee",alignment:"center",cssClass:"right",format:"currency",precision:2},{dataField:"amountDeposit",caption:"Amount Deposit",alignment:"center",cssClass:"right",format:"currency",precision:2},],"export":{enabled:!0,fileName:"MarketingService",allowExportSelectedData:!1},summary:{totalItems:[{column:"count",summaryType:"sum",valueFormat:"currency",precision:2},{column:"totalCredit",summaryType:"sum",valueFormat:"currency",precision:2},{column:"marketingFee",summaryType:"sum",valueFormat:"currency",precision:2},{column:"creditCardFee",summaryType:"sum",valueFormat:"currency",precision:2},{column:"amountDeposit",summaryType:"sum",valueFormat:"currency",precision:2}]},onRowPrepared:function(n){n.rowElement.addClass("datagrid-summary-state-hover")},onToolbarPreparing:function(n){n.toolbarOptions.items.unshift({location:"after",widget:"dxDateBox",options:{acceptCustomValue:!1,format:"date",width:170,value:new Date,displayFormat:"monthAndYear",maxZoomLevel:"year",minZoomLevel:"century",onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})},onValueChanged:function(n){loadingShimmer(!0,cGridMarketing);i(cfrmMarketingServiceGetData,moment(n.value).format(moment_date_format_mmddyyyy))}}})}})}function EgiftCardViewModel(n){var i,t=this;t.data=ko.observableArray([]);t.dataGiftCer=ko.observable();t.dataGiftCerModal=new DataGiftCerModel;t.dataGiftCerDetailModal=new DataGiftCerDetailModel;t.dataGiftCerSearchModal=new DataGiftCerSearchModel;t.dataGiftCerSearchDateModal=new DataGiftCerSearchDateModel(n);t.selectGiftCerId=ko.observable();t.loadingVisible=ko.observable(!1);t.loadOptions={visible:t.loadingVisible,showIndicator:!0,showPane:!0,shading:!0,closeOnOutsideClick:!1,shadingColor:"rgba(0,0,0,0.4)",position:{my:"center",at:"center",of:window},onShown:function(){var i=new ObjUrl(cJsonGetWrGiftCerX),r=i.getUrlFromJson(),u=JSON.parse('{"key" : "'+t.selectGiftCerId()+'"}'),n=JSON.parse(getJsonFromAjax(r,!ajax_async,ajax_cache,ajax_type_post,u,ajax_timeout));t.dataGiftCerModal.dataJoinDomain.removeAll();n!=null&&n.length>0&&_.forEach(n,function(n){var i=ko.utils.arrayFilter(t.data(),function(t){if(t!=undefined)return t.domainId()==n.customerCode});i.length>0&&t.dataGiftCerModal.dataJoinDomain.push(new DataGiftCerJoinModel(_.head(i).domainId(),_.head(i).domainName()))});t.dataGiftCerModal.action(cStatusUpdate);setTimeout(function(){modalHide(cModalEgiftCardDetail);modalShow(cModalEgiftCard);t.loadingVisible(!1)},1e3)}};t.clickRound=function(n){t.selectGiftCerId(n.giftCerId());t.dataGiftCerModal.isMain(n.isMain());t.dataGiftCerModal.times(n.times());t.loadingVisible(!0)};t.clickNewGiftCer=function(){t.dataGiftCerModal.action(cStatusAdd);modalHide(cModalEgiftCardDetail);t.dataGiftCerModal.isMain(!0);var n=vmViewIndex.egiftcard.dataGiftCerModal.dataJoinDomain();n.length>0&&vmViewIndex.egiftcard.dataGiftCerModal.dataJoinDomain.removeAll();modalShow(cModalEgiftCard)};t.dataGridEgiftCard=ko.observable({onInitialized:function(n){i=n.component},dataSource:t.data,showColumnLines:!0,showRowLines:!0,showBorders:!0,hoverStateEnabled:!0,columnChooser:{enabled:!0,mode:"select"},grouping:{contextMenuEnabled:!0,expandMode:"rowClick"},sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},groupPanel:{visible:!1},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{caption:"#",width:80,alignment:"center",cellTemplate:function(n,t){n.text(i.pageIndex()*i.pageSize()+t.rowIndex+1)}},{dataField:"domainId",caption:"ID",alignment:"center",width:"120px"},{dataField:"domainDesc",caption:"Shop Name",alignment:"center",cssClass:"left",sortOrder:"asc"},{dataField:"active",caption:"",width:80,alignment:"center",allowFiltering:!1}],onCellPrepared:function(n){var i=n.column,r=n.value,t="";i.dataField==="active"&&(isEmpty(r)||(t="<span><i class='fa fa-list-alt'><\/i><\/span>",n.cellElement.html(t)))},onRowPrepared:function(n){n.rowElement.addClass("datagrid-summary-state-hover")},onCellClick:function(n){var i=n.data,r;n.rowType=="data"&&n.column.dataField=="active"?(t.dataGiftCerSearchDateModal.domainId(i.domainId()),t.dataGiftCerSearchDateModal.domainName(i.domainName()),modalShow(cModalEgiftCardSearchDate),$(".slickSetup").slick("setPosition")):n.rowType=="data"&&(t.dataGiftCerModal.domainId(i.domainId()),t.dataGiftCerModal.domainName(i.domainName()),t.dataGiftCerModal.storeDomain.clear(),_.forEach(t.dataGiftCerModal.storeDomainData._array,function(n){n.domainId()!=t.dataGiftCerModal.domainId()&&t.dataGiftCerModal.storeDomain.insert(n)}),refreshLookUp($("#dxLookupJoinGiftCer")),r=ko.utils.arrayFilter(t.dataGiftCer(),function(n){return n.customerCode()==i.domainId()}),isEmpty(r)?modalShow(cModalEgiftCard):(t.dataGiftCerDetailModal.data.removeAll(),_.forEach(r,function(n){t.dataGiftCerDetailModal.data.push(n)}),t.dataGiftCerDetailModal.domainId(i.domainId()),t.dataGiftCerDetailModal.domainName(i.domainId()),modalShow(cModalEgiftCardDetail)))},onRowClick:function(){},onToolbarPreparing:function(n){n.toolbarOptions.items.unshift({location:"after",widget:"dxButton",options:{icon:"fa fa-th-list",onClick:function(){modalShow(cModalEgiftCardSearch)}}})}})}