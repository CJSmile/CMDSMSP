function DataMonitorViewModel(){var n=this;n.domainId=ko.observable("");n.domainValue=ko.observable("");n.shopName=ko.observable("");n.shopAddress=ko.observable("");n.shopPhone=ko.observable("");n.shopTicket=ko.observable("");n.ticketId=ko.observable(0);n.orderTypeName=ko.observable("");n.subTotal=ko.observable(0);n.deliveryCharge=ko.observable(0);n.autoCharge=ko.observable(0);n.paymentFee=ko.observable(0);n.discount=ko.observable(0);n.tax=ko.observable(0);n.tip=ko.observable(0);n.utensilsAmount=ko.observable(0);n.grandTotal=ko.observable(0);n.scheduleDateTime=ko.observable("");n.todayAsap=ko.observable(!0);n.ticketDateTime=ko.observable("");n.send=ko.observable(!1);n.confirm=ko.observable(!1);n.isGuest=ko.observable(!1);n.printCount=ko.observable(0);n.paymentType=ko.observable("");n.customerName=ko.observable("");n.customerAddress=ko.observable("");n.customerPhone=ko.observable("");n.shopUsePos=ko.observable("");n.groupOrder=ko.observableArray([]);n.groupTicketPayment=ko.observableArray([]);n.sumOrderChoiceName=ko.observable("");n.feeCreditAndMarketing=ko.observable("");n.ticketStatus=ko.observable("");n.domainName=ko.observable("")}function DatSetupViewModel(n){var t=this,i;t.action=ko.observable(cStatusAdd);t.domainId=ko.observable("0");t.domainName=ko.observable("");t.domainNameTemplate=ko.observable(null);t.domainNameTemplateUrl=ko.observable(null);t.domainValue=ko.observable("");t.domainDesc=ko.pureComputed(function(){return t.shopName()});t.signalR=ko.observable(!0);t.usePos=ko.observable(!0);t.useTemplate=ko.observable(!1);t.active=ko.observable(!0);t.sourceKey=ko.observable("");t.pin=ko.observable("");t.estimateTime=ko.observable(!0);t.captchaEnable=ko.observable(!1);t.captchaKeepAlive=ko.observable(!1);t.apiKey=ko.observable("");t.marketingKey=ko.observable("");t.arrProduct=ko.observableArray([]);t.selectCheckBoxProduct=ko.observableArray([]);t.productId=ko.observable("");t.currentProductId=ko.observable("");t.showPaymentContactless=ko.observable(!1);t.showSmileDining=ko.observable(!1);t.showSmileContactless=ko.observable(!1);t.showThirdPartyIntegrations=ko.observable(!1);t.accountName=ko.observable("");t.locationName=ko.observable("");t.accountId=ko.observable("");t.locationId=ko.observable("");t.listLocation=ko.observableArray([]);t.locationSelect=ko.observable("0");t.selectLocation=ko.observable({acceptCustomValue:!1,dataSource:t.listLocation,displayExpr:"locationName",value:t.locationSelect,valueExpr:"locationId",dropDownButtonTemplate:"dropDownButton",onItemClick:function(n){n.itemData!=null&&(vmViewIndex.setup.dataModal.locationId(ko.toJSON(n.itemData)),isLoading(!0),setTimeout(function(){var r=JSON.parse(getObjFormAjax(cJsonGetDataDispatch,t.domainId()+","+n.itemData.locationId())),i;t.listDispatch([]);n.itemData.locationId()==t.initLocationId()&&t.listDispatch(t.initListDispatch());t.dispatchStore([]);i=[];ko.utils.arrayForEach(r,function(n){t.dispatchStore.push({dispatchId:ko.observable(n.dispatchId),dispatchName:ko.observable(n.dispatchName)});i.push(n.dispatchId)});t.currentDispatchIdStore("");t.currentDispatchIdStore(ko.toJSON(i));isLoading(!1)},0))}});t.dispatchType=ko.observable("");t.initLocationId=ko.observable("");t.initListDispatch=ko.observableArray([]);t.listDispatchSelect=ko.observable("");t.dispatchStore=ko.observableArray([]);t.currentDispatchIdStore=ko.observable("");t.listDispatch=ko.observableArray([]);t.selectDispatch=ko.observable({dataSource:t.dispatchStore,displayExpr:"dispatchName",valueExpr:"dispatchId",value:t.listDispatch,showDropDownButton:!0,searchEnabled:!0,showSelectionControls:!0,maxDisplayedTags:2,showMultiTagOnly:!1,onValueChanged:function(n){var i=1;if(n.value.length>i){const t=n.value.slice(0,i);n.component.option("value",t)}t.listDispatchSelect("");n.value.length>0&&t.listDispatchSelect(ko.toJSON(n.value.slice(0,i)))}});t.clickSelectCheckBoxProduct=function(){var r=t.currentProductId(),n,i;return t.currentProductId(r),n=[],t.productId(""),ko.utils.arrayForEach(t.selectCheckBoxProduct(),function(t){n.push(parseInt(t))}),i=_.sortBy(n),_.forEach(i,function(n){if(t.productId().length==0)t.productId(n+"");else{var i=t.productId();t.productId(i+","+n)}}),t.selectCheckBoxProduct().includes(products.cSmileContactless)?(t.showPaymentContactless(!0),t.showSmileContactless(!0)):(t.showPaymentContactless(!1),t.contactlessPaymentType(contactlessPaymentType.cFastService),t.showSmileContactless(!1)),t.selectCheckBoxProduct().includes(products.cSmileDining)?t.showSmileDining(!0):t.showSmileDining(!1),t.selectCheckBoxProduct().includes(products.cSmileThirdPartyIntegrations)&&t.active()?(t.showThirdPartyIntegrations(!0),$(".slickSetup .slick-dots li:nth-of-type(4)").removeClass("d-none")):(t.showThirdPartyIntegrations(!1),$(".slickSetup .slick-dots li:nth-of-type(4)").addClass("d-none")),!0};t.clickSearchDeliverectAccount=function(){deliverectSaveData(cfrmDeliverectActivateAccount)};t.clickZyncProduct=function(){deliverectSaveData(cfrmDeliverectInsertOrUpdateProduct)};t.clickResizeImage=function(){ResizeImage(!0)};t.clickCreateIconImage=function(){createIconImageCustomDomain()};t.status=ko.observable(!0);t.closeReson=ko.observable("");t.closeStartDate=ko.observable("");t.closeEndDate=ko.observable("");t.currentDate=ko.observable(moment(n).format("MM/DD/YYYY"));t.statusContactless=ko.observable(!0);t.closeResonContactless=ko.observable("");t.closeStartDateContactless=ko.observable("");t.closeEndDateContactless=ko.observable("");t.computeMinEndDate=ko.pureComputed(function(){return t.closeStartDate()==null||isEmpty(t.closeStartDate())?t.currentDate():moment(t.closeStartDate()).isAfter(t.currentDate())?t.closeStartDate():t.currentDate()});t.dateBoxCloseStartDate=ko.observable({type:"date",pickerType:"calendar",value:t.closeStartDate,min:t.currentDate,displayFormat:"MM-dd-yyyy",onValueChanged:function(n){var i=moment(n.value).format(moment_date_format_mmddyyyy);i=="Invalid date"?t.closeStartDate(""):t.closeStartDate(i)}});t.dateBoxCloseEndDate=ko.observable({type:"date",pickerType:"calendar",value:t.closeEndDate,min:t.computeMinEndDate,displayFormat:"MM-dd-yyyy",onValueChanged:function(n){var i=moment(n.value).format(moment_date_format_mmddyyyy);i=="Invalid date"?t.closeEndDate(""):t.closeEndDate(i)}});t.computeMinEndDateContactless=ko.pureComputed(function(){return t.closeStartDateContactless()==null||isEmpty(t.closeStartDateContactless())?t.currentDate():moment(t.closeStartDateContactless()).isAfter(t.currentDate())?t.closeStartDateContactless():t.currentDate()});t.dateBoxCloseStartDateContactless=ko.observable({type:"date",pickerType:"calendar",value:t.closeStartDateContactless,min:t.currentDate,displayFormat:"MM-dd-yyyy",onValueChanged:function(n){var i=moment(n.value).format(moment_date_format_mmddyyyy);i=="Invalid date"?t.closeStartDateContactless(""):t.closeStartDateContactless(i)}});t.dateBoxCloseEndDateContactless=ko.observable({type:"date",pickerType:"calendar",value:t.closeEndDateContactless,min:t.computeMinEndDateContactless,displayFormat:"MM-dd-yyyy",onValueChanged:function(n){var i=moment(n.value).format(moment_date_format_mmddyyyy);i=="Invalid date"?t.closeEndDateContactless(""):t.closeEndDateContactless(i)}});t.shopNumber=ko.pureComputed(function(){return t.domainId()});t.shopName=ko.observable("");t.shopAddress=ko.observable("");t.shopCity=ko.observable("");t.shopState=ko.observable("");t.shopPostal=ko.observable("");t.shopPhone=ko.observable("");t.shopFax=ko.observable("");t.shopEmail=ko.observable("");t.shopEmailGiftCard=ko.observable("");t.lat=ko.observable("");t.lng=ko.observable("");t.timeZoneCode=ko.observable("");t.timePickupStart=ko.observable(0).extend({numeric:0});t.timePickupEnd=ko.observable(0).extend({numeric:0});t.timeDeliveryStart=ko.observable(0).extend({numeric:0});t.timeDeliveryEnd=ko.observable(0).extend({numeric:0});t.store=new DevExpress.data.ArrayStore({data:[],key:"timeZoneCode"});t.dxLookuptimeZoneCode=ko.observable({dataSource:t.store,displayExpr:"name",valueExpr:"timeZoneCode",value:"",showPopupTitle:!1,onValueChanged:function(n){var r=n.previousValue,i=n.value;t.timeZoneCode(i)}});t.serviceFee=ko.observable(0).extend({numeric:2});t.deliveryChargeTax=ko.observable(0).extend({numeric:2});t.creditCardFee=ko.observable(0).extend({numeric:2});t.marketingServiceFee=ko.observable(0).extend({numeric:2});t.feeCreditAndMarketing=ko.observable(!1);t.minimumOrder=ko.observable(0).extend({numeric:2});t.minimumOrderForPickup=ko.observable(0).extend({numeric:2});t.showminimumOrderForPickup=ko.observable(!1);t.calDeliveryTax=ko.observable(!0);t.commissionRule=ko.observable("1");t.isCalTax=ko.observable(!0);t.isCalTaxContactless=ko.observable(!0);t.pickupPayCash=ko.observable(!0);t.pickupPayCredit=ko.observable(!0);t.deliveryPayCash=ko.observable(!0);t.deliveryPayCredit=ko.observable(!0);t.statementType=ko.observable("1");t.mapCode=ko.observable("1");t.shippingType=ko.observable("2");t.menuHourTimeStart=ko.observable("ASAP");t.contactlessPaymentType=ko.observable(contactlessPaymentType.cFastService);t.isCustomTimeMenu=ko.observable(!1);t.customDay=ko.observable(0).extend({numeric:0});t.customHours=ko.observable(0).extend({numeric:0});t.isShowCustomTimeMenu=ko.observable(!1);t.autoSyncProduct=ko.observable(!1);t.tipAuto=ko.observable("");t.tipGuide=ko.observable("");t.dispatchServiceCharge=ko.observable(0).extend({numeric:2});i=[];i.push({key:"1",value:"Percentage"});i.push({key:"2",value:"Transaction"});i.push({key:"3",value:"Tier"});t.dxLookupCommission=ko.observable({dataSource:new DevExpress.data.ArrayStore({data:i,key:"key"}),displayExpr:"value",valueExpr:"key",value:"1",showPopupTitle:!1,onValueChanged:function(n){var r=n.previousValue,i=n.value;t.commissionRule(i)}});t.dxNumBoxTimePickupStart={value:t.timePickupStart};t.dxNumBoxTimePickupEnd={value:t.timePickupEnd};t.dxNumBoxTimeDeliveryStart={value:t.timeDeliveryStart};t.dxNumBoxTimeDeliveryEnd={value:t.timeDeliveryEnd};t.blurDomainId=function(){var n=$(event.target).val();$.isNumeric(n)||(n=0);t.domainId(n)};t.blurTimePickupStart=function(){var n=$(event.target).val();n=$.isNumeric(n)?parseInt(n):0;n<0&&(n=0);t.timePickupStart(n)};t.blurTimePickupEnd=function(){var n=$(event.target).val();n=$.isNumeric(n)?parseInt(n):0;n<0&&(n=0);t.timePickupEnd(n)};t.blurTimeDeliveryStart=function(){var n=$(event.target).val();n=$.isNumeric(n)?parseInt(n):0;n<0&&(n=0);t.timeDeliveryStart(n)};t.blurTimeDeliveryEnd=function(){var n=$(event.target).val();n=$.isNumeric(n)?parseInt(n):0;n<0&&(n=0);t.timeDeliveryEnd(n)};t.blurMinimumOrder=function(){var n=$(event.target).val();n=$.isNumeric(n)?parseFloat(n):0;n<0&&(n=0);t.minimumOrder(n)};t.blurMinimumOrderForPickup=function(){var n=$(event.target).val();n=$.isNumeric(n)?parseFloat(n):0;n<0&&(n=0);t.minimumOrderForPickup(n)};t.blurServiceFee=function(){var n=$(event.target).val();n=$.isNumeric(n)?rountTwo(n):0;n<0&&(n=0);t.serviceFee(n)};t.blurDeliveryChargeTax=function(){var n=$(event.target).val();n=$.isNumeric(n)?rountTwo(n):0;n<0&&(n=0);t.deliveryChargeTax(n)};t.blurCreditCardFee=function(){var n=$(event.target).val();n=$.isNumeric(n)?rountTwo(n):0;n<0&&(n=0);t.creditCardFee(n)};t.blurDispatchServiceCharge=function(){var n=$(event.target).val();n=$.isNumeric(n)?rountTwo(n):0;n<0&&(n=0);t.dispatchServiceCharge(n)};t.blurMarketingServiceFee=function(){var n=$(event.target).val();n=$.isNumeric(n)?rountTwo(n):0;n<0&&(n=0);t.marketingServiceFee(n)};t.clickFeeCreditAndMarketing=function(){var n=$(event.target).val();!t.feeCreditAndMarketing()&&n&&(!vmViewIndex.setup.dataModal.pickupPayCash()&&vmViewIndex.setup.dataModal.pickupPayCredit()&&!vmViewIndex.setup.dataModal.deliveryPayCash()&&vmViewIndex.setup.dataModal.deliveryPayCredit()?(vmViewIndex.setup.dataModal.feeCreditAndMarketing(!0),$("#btnDomain_MarketingServiceFeeYes").addClass("active"),$("#btnDomain_MarketingServiceFeeNo").removeClass("active")):swalConfirmActivateCreditCardAndMarkeingServiceFee());t.feeCreditAndMarketing()&&!n&&(t.feeCreditAndMarketing(!1),$("#btnDomain_MarketingServiceFeeYes").removeClass("active"),$("#btnDomain_MarketingServiceFeeNo").addClass("active"),swal(cSwal_Alert_Warning,"Please recheck payment type.",cSwal_Icon_Warning))};t.clicksignalR=function(){var n=$(event.target).val();t.signalR()!=n&&t.signalR(n)};t.clickActive=function(){var n=$(event.target).val();t.active()!=n&&(t.active(n),t.selectCheckBoxProduct().includes(products.cSmileThirdPartyIntegrations)&&t.active()?(t.showThirdPartyIntegrations(!0),$(".slickSetup .slick-dots li:nth-of-type(4)").removeClass("d-none")):(t.showThirdPartyIntegrations(!1),$(".slickSetup .slick-dots li:nth-of-type(4)").addClass("d-none")))};t.clickUsePos=function(){var n=$(event.target).val();t.usePos()!=n&&t.usePos(n)};t.clickUseTemplate=function(){var n=$(event.target).val();t.useTemplate()!=n&&t.useTemplate(n)};t.clickCaptchaEnable=function(){var n=$(event.target).val();t.captchaEnable()!=n&&t.captchaEnable(n)};t.clickCaptchaKeepAlive=function(){var n=$(event.target).val();t.captchaKeepAlive()!=n&&t.captchaKeepAlive(n)};t.clickStatus=function(){var n=$(event.target).val();t.status()!=n&&t.status(n)};t.clickStatusContactless=function(){var n=$(event.target).val();t.statusContactless()!=n&&t.statusContactless(n)};t.clickEstimateTime=function(){var n=$(event.target).val();t.estimateTime()!=n&&t.estimateTime(n)};t.clickMapCode=function(){var n=$(event.target).val();t.mapCode()!=n&&t.mapCode(n)};t.clickShippingTypePickup=function(){t.shippingType("0")};t.clickShippingTypeDelivery=function(){t.shippingType("1")};t.clickShippingTypeBoth=function(){t.shippingType("2")};t.clickMenuHourStartAsap=function(){t.menuHourTimeStart("ASAP");t.isCustomTimeMenu(!1)};t.clickMenuHourStartToday=function(){t.menuHourTimeStart("TODAY");t.isCustomTimeMenu(!1)};t.clickMenuHourStartTodayOnly=function(){t.menuHourTimeStart("TODAYONLY");t.isCustomTimeMenu(!1)};t.clickMenuHourStartNoAsap=function(){t.menuHourTimeStart("NOASAP");t.isCustomTimeMenu(!1)};t.clickMenuHourStartAsapOnly=function(){t.menuHourTimeStart("ASAPONLY");t.isCustomTimeMenu(!1)};t.clickMenuHourStartCustom=function(){t.menuHourTimeStart("CUSTOM");t.isCustomTimeMenu(!0)};t.blurCustomDay=function(){var n=$(event.target).val();n=$.isNumeric(n)?parseInt(n):0;n<0&&(n=0);t.customDay(n)};t.blurCustomHours=function(){var n=$(event.target).val();n=$.isNumeric(n)?parseInt(n):0;n<0&&(n=0);t.customHours(n)};t.clickPayCashPickup=function(){var n=$(event.target).val();t.pickupPayCash()!=n&&(n&&t.feeCreditAndMarketing()?swalValidatePaymentType(!0,!0):t.pickupPayCash(n))};t.clickPayCreditPickup=function(){var n=$(event.target).val();t.pickupPayCredit()!=n&&(!n&&t.feeCreditAndMarketing()?swalValidatePaymentType(!0,!1):t.pickupPayCredit(n))};t.clickPayCashDelivery=function(){var n=$(event.target).val();t.deliveryPayCash()!=n&&(n&&(t.feeCreditAndMarketing()||t.webDispatch()!=null)?swalValidatePaymentType(!1,!0):t.deliveryPayCash(n))};t.clickPayCreditDelivery=function(){var n=$(event.target).val();t.deliveryPayCredit()!=n&&(!n&&(t.feeCreditAndMarketing()||t.webDispatch()!=null)?swalValidatePaymentType(!1,!1):t.deliveryPayCredit(n))};t.clickCalDeliveryTax=function(){var n=$(event.target).val();t.calDeliveryTax()!=n&&t.calDeliveryTax(n)};t.clickCalTax=function(){var n=$(event.target).val();t.isCalTax()!=n&&t.isCalTax(n)};t.clickCalTaxContaceless=function(){var n=$(event.target).val();t.isCalTaxContactless()!=n&&t.isCalTaxContactless(n)};t.clickStatementType=function(){var n=$(event.target).val();t.statementType()!=n&&t.statementType(n)};t.clickFastService=function(){t.contactlessPaymentType(contactlessPaymentType.cFastService)};t.clickFineDining=function(){t.contactlessPaymentType(contactlessPaymentType.cFineDining)};t.clickAutoSyncProduct=function(){var n=$(event.target).val();t.autoSyncProduct()!=n&&t.autoSyncProduct(n)};t.webDispatch=ko.observable(null);t.clickWebDispatchYes=function(){t.webDispatch()!=!0&&(t.webDispatch(!0),checkDispatch())};t.clickWebDispatchNo=function(){t.webDispatch()!=!1&&(t.webDispatch(!1),checkDispatch())};t.clickWebDispatchNone=function(){t.webDispatch()!=null&&(t.webDispatch(null),t.dispatchType(cDispatchType_None),swal(cSwal_Alert_Warning,"Please recheck payment type.",cSwal_Icon_Warning))};t.clickDispatchType=function(){var n=$(event.target).val();t.dispatchType()!=n&&(t.dispatchType(n),checkDispatch())};t.isClickShopCloseSmileDining=ko.observable(!0);t.clickCustomShopClose=function(){var n=JSON.parse(getObjFormDomainFormAjax(cJsonGetShopClose,t.domainId(),products.cSmileDining));DataShopCloseSetUpViewModel(n);t.isClickShopCloseSmileDining(!0);$("#modalShowShopClose").modal({keyboard:!1,backdrop:"static",show:!0})};t.clickCustomShopCloseContactless=function(){var n=JSON.parse(getObjFormDomainFormAjax(cJsonGetShopClose,t.domainId(),products.cSmileContactless));DataShopCloseSetUpViewModel(n);t.isClickShopCloseSmileDining(!1);$("#modalShowShopClose").modal({keyboard:!1,backdrop:"static",show:!0})};t.clickCloseModalShowShopClose=function(){$("#modalSetup").css({"overflow-x":"hidden","overflow-y":"auto"})};t.dataShopClose=ko.observableArray([]);t.dataSetUpModalShopClose=new SetUpShopCloseViewModel;t.dataGridShopClose=ko.observable({dataSource:t.dataShopClose,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!1,columnHidingEnabled:!1,rowAlternationEnabled:!1,onInitialized:function(n){dataGrid=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(dataGrid.pageIndex()*dataGrid.pageSize()+t.rowIndex+1)}},{dataField:"startDate",caption:"StartDate",alignment:"center",dataType:"date",width:"200"},{dataField:"endDate",caption:"EndDate",alignment:"center",dataType:"date",width:"200"},{dataField:"reason",caption:"CloseReason",width:"200"},{dataField:"time",caption:"",width:80,alignment:"center"}],onCellPrepared:function(n){var i=n.column,r=n.value,t="";i.dataField==="time"&&(isEmpty(r)||(t="<span><i class='fa fa-trash fa-lg' style='color:red;'><\/i><\/span>",n.cellElement.html(t)))},onCellClick:function(n){var r=n.data,u,f,i;n.rowType=="data"&&n.column.dataField=="time"?(u="",u=r.time().length==1?_.first(r.time()).shopCloseId():r.time()[0].shopCloseId()+","+r.time()[1].shopCloseId(),swalConfirmDeleteShopClose(cfrmDeleteShopClose,u)):n.rowType=="data"&&(f=ko.mapping.toJSON(r),ko.mapping.fromJSON(f,{},t.dataSetUpModalShopClose),i=r.time(),i[0].startTimePmAm()!=null&&i[1].startTimePmAm!=null&&i.sort(function(n,t){var i=moment(n.startTimePmAm(),moment_time_format_hhmmssa),r=moment(t.startTimePmAm(),moment_time_format_hhmmssa);return i>r?1:-1}),t.dataSetUpModalShopClose.shopCloseIdFirst(_.first(i).shopCloseId()),t.dataSetUpModalShopClose.hasShowSecondTime(!0),_.first(i).startTime()==time_start_24h&&_.first(i).endTime()==time_end_24h?(t.dataSetUpModalShopClose.valActive24Hour(!0),t.dataSetUpModalShopClose.valFirstHourStartTime(moment(time_start_24h,moment_time_format_hhmmss)),t.dataSetUpModalShopClose.valFirstHourEndTime(moment(time_end_24h,moment_time_format_hhmmss))):(t.dataSetUpModalShopClose.valActive24Hour(!1),t.dataSetUpModalShopClose.valFirstHourStartTime(moment(_.first(i).startTime(),moment_time_format_hhmmss)),t.dataSetUpModalShopClose.valFirstHourEndTime(moment(_.first(i).endTime(),moment_time_format_hhmmss))),i.length>1&&(t.dataSetUpModalShopClose.valSecondHourStartTime(moment(i[1].startTime(),moment_time_format_hhmmss)),t.dataSetUpModalShopClose.valSecondHourEndTime(moment(i[1].endTime(),moment_time_format_hhmmss)),t.dataSetUpModalShopClose.shopCloseIdSecond(i[1].shopCloseId()),t.dataSetUpModalShopClose.hasShowSecondTime(!1)),t.dataSetUpModalShopClose.disableButtonSubmit(!1),$("#modalSetUpShopClose").modal({keyboard:!1,backdrop:"static",show:!0}),t.dataSetUpModalShopClose.chkBtnUpdate(!0),t.dataSetUpModalShopClose.chkBtnAdd(!1))},onToolbarPreparing:function(n){var i=n.toolbarOptions.items;i.push({widget:"dxButton",location:"after",options:{icon:"fa fa-search",hint:"Search",onClick:function(){t.chkSearch()==!1?t.chkSearch(!0):t.chkSearch()==!0&&t.chkSearch(!1)}}},{widget:"dxButton",location:"after",options:{icon:"fa fa-plus",hint:"Add",onClick:function(){t.dataSetUpModalShopClose.disableButtonSubmit(!1);t.dataSetUpModalShopClose.valFirstHourStartTime(moment(time_start_24h,moment_time_format_hhmmss));t.dataSetUpModalShopClose.valFirstHourEndTime(moment(time_end_24h,moment_time_format_hhmmss));t.dataSetUpModalShopClose.hasShowSecondTime(!0);$("#modalSetUpShopClose").modal({keyboard:!1,backdrop:"static",show:!0});t.dataSetUpModalShopClose.chkBtnUpdate(!1);t.dataSetUpModalShopClose.chkBtnAdd(!0)}}})},searchPanel:{visible:t.chkSearch,placeholder:"Search...",highlightSearchText:!1},loadPanel:{enabled:!0,showPane:!1,text:""},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},onRowPrepared:function(n){n.rowElement.addClass("myRow-hover")},onContentReady:function(){$("#gridShopClose .dx-scrollable").dxScrollable({showScrollbar:"always"})}})}function DataShopCloseSetUpViewModel(n){var i=vmViewIndex.setup.dataModal,r=_.groupBy(n,function(n){return n.startDate+"#"+n.endDate}),t=[];_.forEach(r,function(n){var i=[];i.push(new DataTimeCloseViewModel(n[0]));n.length>1&&i.push(new DataTimeCloseViewModel(n[1]));t.push({startDate:n[0].startDate,endDate:n[0].endDate,reason:n[0].reason,time:i})});ko.mapping.fromJS(t,{},i.dataShopClose)}function DataShopCloseViewModel(n){var t=this,i=_.first(n),r;t.startDate=ko.observable(i.startDate);t.endDate=ko.observable(i.endDate);t.reason=ko.observable(i.reason);r=[];ko.utils.arrayForEach(n,function(n){var t=new DataTimeCloseViewModel(n);r.push(t)});t.time=ko.observableArray(r.slice(0))}function DataTimeCloseViewModel(n){var t=this;t.startTime=ko.observable(n.startTime);t.endTime=ko.observable(n.endTime);t.startTimePmAm=ko.observable(n.startTimePmAm);t.endTimePmAm=ko.observable(n.endTimePmAm);t.shopCloseId=ko.observable(n.shopCloseId)}function SetUpShopCloseViewModel(){var n=this;n.shopCloseIdFirst=ko.observable("");n.shopCloseIdSecond=ko.observable("");n.startDate=ko.observable(moment().format("L"));n.endDate=ko.observable(moment().format("L"));n.startTime=ko.observable(null);n.endTime=ko.observable(null);n.reason=ko.observable("");n.valFirstHourStartTime=ko.observable(null);n.valFirstHourEndTime=ko.observable(null);n.valSecondHourStartTime=ko.observable(null);n.valSecondHourEndTime=ko.observable(null);n.valActive24Hour=ko.observable(!0);n.hasShowSecondTime=ko.observable(!1);n.enableSaveChanges=ko.observable(!0);n.chkBtnUpdate=ko.observable(!1);n.chkBtnAdd=ko.observable(!0);n.disableButtonSubmit=ko.observable(!1);n.dateFromDateBox=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.startDate,width:150,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.startDate(moment(new Date(t.value)).format("L"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onInitialized:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.dateEndDateBox=ko.observable({acceptCustomValue:!1,pickerType:"calendar",type:"date",value:n.endDate,min:n.startDate,width:150,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.endDate(moment(new Date(t.value)).format("L"))},onKeyDown:function(n){n.jQueryEvent.stopPropagation();n.jQueryEvent.preventDefault()},onContentReady:function(n){setTimeout(function(){n.component.field().on("click",function(){n.component.option("opened")||n.component.open()})})}});n.clickActive24Hour=ko.observable({offText:"NO",onText:"YES",value:n.valActive24Hour,width:"55px",onValueChanged:function(n){var t=vmViewIndex.setup.dataModal.dataSetUpModalShopClose;n.value==!0?(t.valFirstHourStartTime(moment(time_start_24h,moment_time_format_hhmmss)),t.valFirstHourEndTime(moment(time_end_24h,moment_time_format_hhmmss)),t.valSecondHourStartTime(null),t.valSecondHourEndTime(null),t.valActive24Hour(!0),t.hasShowSecondTime(!0)):t.valActive24Hour(!1)}});n.timeObj=ko.pureComputed(function(){var t;return t=n.valActive24Hour()?{active24Hour:n.valActive24Hour(),firstStart:moment(time_start_24h,moment_time_format_hhmmss).format(moment_time_format_HHmmss),firstEnd:moment(time_end_24h,moment_time_format_hhmmss).format(moment_time_format_HHmmss),secondStart:null,secondEnd:null,showSecondTime:!n.hasShowSecondTime()}:n.hasShowSecondTime()?{active24Hour:n.valActive24Hour(),firstStart:moment(n.valFirstHourStartTime()).format(moment_time_format_HHmmss),firstEnd:moment(n.valFirstHourEndTime()).format(moment_time_format_HHmmss),secondStart:null,secondEnd:null,showSecondTime:!n.hasShowSecondTime()}:{active24Hour:n.valActive24Hour(),firstStart:moment(n.valFirstHourStartTime()).format(moment_time_format_HHmmss),firstEnd:moment(n.valFirstHourEndTime()).format(moment_time_format_HHmmss),secondStart:moment(n.valSecondHourStartTime()).format(moment_time_format_HHmmss),secondEnd:moment(n.valSecondHourEndTime()).format(moment_time_format_HHmmss),showSecondTime:!n.hasShowSecondTime()},ko.toJSON(t)});n.clickShowSecondTime=function(){n.hasShowSecondTime(!1);n.valSecondHourStartTime(null);n.valSecondHourEndTime(null)};n.clickHiddenSecondTime=function(){n.hasShowSecondTime(!0);n.valSecondHourStartTime(null);n.valSecondHourEndTime(null)};n.valFirstHourStartTimeEdit=ko.observable({max:n.valFirstHourEndTime,pickerType:"list",type:"time",value:n.valFirstHourStartTime,disabled:n.valActive24Hour,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valFirstHourStartTime(t.value);n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.valFirstHourEndTimeEdit=ko.observable({min:n.valFirstHourStartTime,max:n.valSecondHourStartTime,type:"time",pickerType:"list",value:n.valFirstHourEndTime,disabled:n.valActive24Hour,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valFirstHourEndTime(t.value);n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.valSecondHourStartTimeEdit=ko.observable({min:n.valFirstHourEndTime,max:n.valSecondHourEndTime,type:"time",pickerType:"list",value:n.valSecondHourStartTime,disabled:n.valActive24Hour,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valSecondHourStartTime(t.value);n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.valSecondHourEndTimeEdit=ko.observable({min:n.valSecondHourStartTime,type:"time",pickerType:"list",value:n.valSecondHourEndTime,disabled:n.valActive24Hour,onValueChanged:function(t){(t.value===""||t.value===null||t.value===undefined)&&t.component.option("isValid",!1);n.valSecondHourEndTime(t.value);n.enableSaveChanges(!0)},onChange:function(t){t.component._options.validationError!=null?n.enableSaveChanges(!1):n.enableSaveChanges(!0)}});n.btnCloseSetUpShopClose=function(){n.clearSetUpShopClose()};n.clearSetUpShopClose=function(){n.shopCloseIdFirst("");n.shopCloseIdSecond("");n.startDate(moment().format("L"));n.endDate(moment().format("L"));n.startTime(null);n.endTime(null);n.reason("");n.valFirstHourStartTime(moment(time_start_24h,moment_time_format_hhmmss));n.valFirstHourEndTime(moment(time_end_24h,moment_time_format_hhmmss));n.valSecondHourStartTime(null);n.valSecondHourEndTime(null);n.valActive24Hour(!0);n.hasShowSecondTime(!0);n.enableSaveChanges(!0)}}function DataOwnerViewModel(){var n=this;n.customerId=ko.observable("");n.ownerId=ko.observable("");n.ownerPhone=ko.observable("");n.email=ko.observable("");n.firstName=ko.observable("");n.lastName=ko.observable("");n.password=ko.observable("");n.confirmPassword=ko.observable("");n.domainId=ko.observable("");n.action=ko.observable(cStatusAdd);n.domainDesc=ko.observable("");n.showPassword=ko.observable(!0);n.clickShowPassword=function(){n.showPassword(!n.showPassword());n.showPassword()==!1&&(n.password(""),n.confirmPassword(""))};n.customerKey=ko.pureComputed(function(){return n.domainId()+":"+n.email()});n.store=new DevExpress.data.ArrayStore({data:[],key:"domainId"});n.dxLookupDomain=ko.observable({dataSource:n.store,displayExpr:"domainDesc",valueExpr:"domainId",value:"",showPopupTitle:!1,onValueChanged:function(t){var r=t.previousValue,i=t.value;n.domainId(i)},onSelectionChanged:function(t){var i=t.selectedItem.domainDesc();n.domainDesc(i)}})}function DataChangePasswordViewModel(){var n=this;n.email=ko.observable("");n.firstName=ko.observable("");n.lastName=ko.observable("");n.currentPassword=ko.observable("");n.newPassword=ko.observable("");n.confirmPassword=ko.observable("");n.showPassword=ko.observable(!1);n.clickShowPassword=function(){n.showPassword(!n.showPassword());n.showPassword()==!1&&(n.currentPassword(""),n.newPassword(""),n.confirmPassword(""))}}function DataCreateAccountViewModel(){var n=this;n.firstName=ko.observable("");n.lastName=ko.observable("");n.email=ko.observable("");n.newPassword=ko.observable("");n.confirmPassword=ko.observable("");n.securityCode=ko.observable("")}function DataUserViewModel(){var n=this;n.userId=ko.observable(null);n.email=ko.observable("");n.firstName=ko.observable("");n.lastName=ko.observable("");n.phone=ko.observable("");n.active=ko.observable(!0);n.enableSendResetPassword=ko.observable(!0);n.action=ko.observable(cStatusAdd);n.clickResetpassword=function(){isEmpty(n.email())?swal(cSwal_Alert_Error,replaceNewLineToBr("require email"),cSwal_Icon_Error):(n.enableSendResetPassword(!1),sendResetPasswordForWebReport(n.email()))};n.clickActive=function(){n.active(!n.active())}}function sendResetPasswordForWebReport(n){var t=firebase.auth(),i=n;t.sendPasswordResetEmail(i).then(function(){vmViewIndex.webreport.dataUserModal.enableSendResetPassword(!0);swal(cSwal_Alert_Success,replaceNewLineToBr("Reset password is success."),cSwal_Icon_Success)}).catch(function(n){var t=n.code,i=n.message;swal(cSwal_Alert_Error,replaceNewLineToBr("Email is incorrectly formatted."),cSwal_Icon_Error)})}function DataRoleMenuMapModel(){var n=this;n.roleMenuMapId=ko.observable(null);n.customerId=ko.observable(null);n.roleMenuMap=ko.observableArray([]);n.action=ko.observable(cStatusAdd);n.dataObj=ko.computed(function(){return ko.toJSON(n.roleMenuMap())});n.storeCustomer=new DevExpress.data.ArrayStore({data:[],key:"customerId"});n.dxLookupCustomerValid=ko.observable(!0);n.dxLookupCustomerValidError=ko.observableArray([]);n.dxLookupCustomer=ko.observable({dataSource:n.storeCustomer,displayExpr:"shopName",valueExpr:"customerId",value:"",showPopupTitle:!1,onValueChanged:function(t){var r=t.previousValue,i=t.value,u=ko.utils.arrayFilter(vmViewIndex.webreport.dataRoleMenuMap(),function(n){return n.customerId()==i});if(isEmpty(i)&&!isEmpty(r))return swal(cSwal_Alert_Error,replaceNewLineToBr(cError_Restaurant_Empty),cSwal_Icon_Error),n.dxLookupCustomer({value:""}),n.customerId(null),!1;n.customerId(i);removeErrorMessageRoleMenuMap()},isValid:n.dxLookupCustomerValid,validationError:n.dxLookupCustomerValidError})}function ChildrenDataRoleMenuMapModel(n,t,i){var r=this,u,f;r.roleId=ko.observable(n);r.roleName=ko.observable(t);r.arrMenu=ko.observableArray([]);u=function(n,t){var i=this;i.menuId=ko.observable(n);i.menuName=ko.observable(t)};f=i.map(function(n){return r.arrMenu.push(n.id),new u(n.id,n.name)});r.clickMenu=function(n){var t=ko.utils.arrayFilter(r.children(),function(t){return t.menuId()==n.menuId()});return t.length>0?r.children.remove(function(t){return t.menuId()==n.menuId()}):r.children.push(new u(n.menuId(),n.menuName())),!0};r.children=ko.observableArray(f)}function DataUserRoleMapModel(){var n=this;n.userRoleMapId=ko.observable(null);n.customerId=ko.observable(null);n.userId=ko.observable(null);n.roleId=ko.observable(null);n.active=ko.observable(!0);n.storeRole=new DevExpress.data.ArrayStore({data:[],key:"roleId"});n.storeCustomer=new DevExpress.data.ArrayStore({data:[],key:"customerId"});n.storeUser=new DevExpress.data.ArrayStore({data:[],key:"userId"});n.dxLookupCustomerValid=ko.observable(!0);n.dxLookupUserValid=ko.observable(!0);n.dxLookupRoleValid=ko.observable(!0);n.dxLookupCustomerValidError=ko.observableArray([]);n.dxLookupUserValidError=ko.observableArray([]);n.dxLookupRoleValidError=ko.observableArray([]);n.dxLookupCustomer=ko.observable({dataSource:n.storeCustomer,displayExpr:"shopName",valueExpr:"customerId",value:"",showPopupTitle:!1,onValueChanged:function(t){var r=t.previousValue,i=t.value;n.customerId(i);removeErrorMessageUserRoleMap()},isValid:n.dxLookupCustomerValid,validationError:n.dxLookupCustomerValidError});n.dxLookupUser=ko.observable({dataSource:n.storeUser,displayExpr:"email",valueExpr:"userId",value:"",showPopupTitle:!1,onValueChanged:function(t){var r=t.previousValue,i=t.value;n.userId(i);removeErrorMessageUserRoleMap()},isValid:n.dxLookupUserValid,validationError:n.dxLookupUserValidError});n.dxLookupRole=ko.observable({dataSource:n.storeRole,displayExpr:"roleName",valueExpr:"roleId",value:"",showPopupTitle:!1,onValueChanged:function(t){var r=t.previousValue,i=t.value;n.roleId(i);removeErrorMessageUserRoleMap()},isValid:n.dxLookupRoleValid,validationError:n.dxLookupRoleValidError});n.action=ko.observable(cStatusAdd)}function DataGiftCerModel(){var n=this;n.domainId=ko.observable();n.domainName=ko.observable("");n.times=ko.observable(0);n.isMain=ko.observable(!0);n.selectJoinDomainId=ko.observable(null);n.selectJoinDomainName=ko.observable("");n.dataJoinDomain=ko.observableArray([]);n.storeDomainData=new DevExpress.data.ArrayStore({data:[],key:"domainId"});n.storeDomain=new DevExpress.data.ArrayStore({data:[],key:"domainId"});n.dxLookupDomainValid=ko.observable(!0);n.dxLookupDomainValidError=ko.observableArray([]);n.dxLookupDomain=ko.observable({dataSource:n.storeDomain,displayExpr:"domainDesc",valueExpr:"domainId",value:"",showPopupTitle:!1,onValueChanged:function(t){var u=t.previousValue,r=t.value,i=_.head(ko.utils.arrayFilter(n.storeDomainData._array,function(n){return n.domainId()===r}));isEmpty(i)?(n.selectJoinDomainId(null),n.selectJoinDomainName("")):(n.selectJoinDomainId(i.domainId()),n.selectJoinDomainName(i.domainName()));removeErrorMessage(cfrmGiftCer)},isValid:n.dxLookupDomainValid,validationError:n.dxLookupDomainValidError});n.clickJoin=function(){var t=_.head(ko.utils.arrayFilter(n.dataJoinDomain(),function(t){return t.domainId()===n.selectJoinDomainId()}));if(!isEmpty(t)&&t.domainId().length>0)return swal(cSwal_Alert_Error,replaceNewLineToBr(cError_Duplicate_Restaurant),cSwal_Icon_Error),n.dxLookupDomain({value:""}),!1;if(n.selectJoinDomainName().length==0)return swal(cSwal_Alert_Error,replaceNewLineToBr(cError_Restaurant_Empty),cSwal_Icon_Error),!1;n.dataJoinDomain.push(new DataGiftCerJoinModel(n.selectJoinDomainId(),n.selectJoinDomainName()));n.dxLookupDomain({value:""})};n.dataObj=ko.pureComputed(function(){return ko.toJSON(n.dataJoinDomain())});n.action=ko.observable(cStatusAdd)}function DataGiftCerJoinModel(n,t){var i=this;i.domainId=ko.observable(n);i.domainName=ko.observable(t);i.close=function(n){vmViewIndex.egiftcard.dataGiftCerModal.dataJoinDomain.remove(function(t){return t.domainId()==n.domainId()})}}function DataGiftCerDetailModel(n,t){var i=this;i.domainId=ko.observable(n);i.domainName=ko.observable(t);i.data=ko.observableArray([])}function DataGiftCerSearchModel(){var n=this;n.search=ko.observable(!1);n.domainId=ko.observable("");n.giftCode=ko.observable();n.blurGiftCode=function(){var t=$(event.target).val();$.isNumeric(t)||(t=0);n.giftCode(t)};n.dataGiftCer=ko.observableArray([]);n.dataGiftCerAccount=ko.observableArray([]);n.dataGiftCerTransaction=ko.observableArray([]);n.dataGridEgiftCard=ko.observable({onInitialized:function(n){dataGrid=n.component},dataSource:n.dataGiftCerTransaction,showColumnLines:!0,showRowLines:!0,showBorders:!0,hoverStateEnabled:!0,sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{caption:"#",width:80,alignment:"center",cellTemplate:function(n,t){n.text(dataGrid.pageIndex()*dataGrid.pageSize()+t.rowIndex+1)}},{dataField:"tDate",caption:"Date",alignment:"center",width:"200px"},{dataField:"tAction",caption:"Description",alignment:"center",cssClass:"left"},{dataField:"tAmount",caption:"Amount",alignment:"center",width:"80px"},{dataField:"tStatus",caption:"Status",alignment:"center",width:"80px"},],onRowClick:function(n){var t=n.data}})}function DataGiftCerSearchDateModel(n){var t=this,i;i=isFireFox()?new Date:getDateJs(moment(n).format(moment_date_format_mmddyyyy));t.startDateBox=ko.observable({type:"date",pickerType:"calendar",value:i,displayFormat:"MM-dd-yyyy",onValueChanged:function(n){var i=moment(n.value).format(moment_date_format_mmddyyyy);t.startDate(i)}});t.endDateBox=ko.observable({type:"date",pickerType:"calendar",value:i,displayFormat:"MM-dd-yyyy",onValueChanged:function(n){var i=moment(n.value).format(moment_date_format_mmddyyyy);t.endDate(i)}});t.startDate=ko.observable(moment(n).format(moment_date_format_mmddyyyy));t.endDate=ko.observable(moment(n).format(moment_date_format_mmddyyyy));t.domainId=ko.observable("");t.giftCode=ko.observable();t.data=ko.observableArray([]);t.dataEgiftCardOnly=ko.observableArray([]);t.dataGiftCerOrder=ko.observableArray([]);t.domainName=ko.observable("");t.dataGridEgiftCard=ko.observable({onInitialized:function(n){dataGrid=n.component},dataSource:t.data,showColumnLines:!0,showRowLines:!0,showBorders:!0,sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{caption:"#",width:80,alignment:"center",cellTemplate:function(n,t){n.text(dataGrid.pageIndex()*dataGrid.pageSize()+t.rowIndex+1)}},{dataField:"giftCode",caption:"Gift Card Number",alignment:"center",cssClass:"center"},{dataField:"accountStatus",caption:"Resend",alignment:"center",width:"80px",allowFiltering:!1},],onCellPrepared:function(n){var i=n.column,r=n.value,t="";i.dataField==="accountStatus"&&(isEmpty(r)||(t="<span><button type='button' class='btn btn-light text-primary' value='RESEND'>Resend<\/button><\/span>",n.cellElement.html(t)))},onCellClick:function(n){var i=n.data,r;n.rowType=="data"&&n.column.dataField=="accountStatus"&&(r={msgType:"warning",msgTitle:"Do you want resend SMS/Email ["+i.giftCode()+"] ?"},swalMessage(r,function(){t.giftCode(i.giftCode());$("#"+cfrmGiftCerSearchDate).submit()}))}});t.dataGridEgiftCardOnly=ko.observable({onInitialized:function(n){dataGrid=n.component},dataSource:t.dataEgiftCardOnly,showColumnLines:!0,showRowLines:!0,showBorders:!0,sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{dataField:"",caption:"#",width:80,alignment:"center",cellTemplate:function(n,t){n.text(dataGrid.pageIndex()*dataGrid.pageSize()+t.rowIndex+1)}},{dataField:"fromEmail",caption:"From",alignment:"center",width:"200"},{dataField:"toEmail",caption:"To Email",alignment:"center",width:"200"},{dataField:"toPhone",caption:"To Phone",alignment:"center",width:"100",dataType:"number"},{dataField:"deliveryDate",caption:"Delivery Date",alignment:"center",width:"110",dataType:"date"},{dataField:"giftCode",caption:"Card Number",alignment:"center",width:"130",dataType:"number"},{dataField:"payAmount",caption:"Pay",alignment:"center",format:"currency",precision:"2",width:"100"},{dataField:"getAmount",caption:"Value",alignment:"center",format:"currency",precision:"2",width:"100"},{dataField:"resend",caption:"Resend",alignment:"center",width:"80px",allowFiltering:!1},],onCellPrepared:function(n){var i=n.column,r=n.value,t="";i.dataField==="resend"&&(isEmpty(r)||(t="<span><button type='button' class='btn btn-light text-primary' value='RESEND'>Resend<\/button><\/span>",n.cellElement.html(t)))},editing:{mode:"popup",allowUpdating:!0,popup:{title:"E-Gift Card",showTitle:!0,width:600,height:300,position:{my:"top",at:"top",of:window}},form:{items:[{itemType:"group",colCount:2,colSpan:2,items:["toEmail","toPhone"]}]}},onEditorPreparing:function(n){n.parentType=="dataRow"&&n.dataField=="toEmail"&&(n.editorOptions.maxLength=50);n.parentType=="dataRow"&&n.dataField=="toPhone"&&(n.editorOptions.maxLength=10)},onRowUpdated:function(n){var r=n.key,e=r.giftCode(),i=_.find(t.dataGiftCerOrder(),function(n){return n.giftCode()==e}),u=i.email(),f=i.phone();i.email()!=r.toEmail()&&(u=r.toEmail()==null?"":r.toEmail());i.phone()!=r.toPhone()&&(f=r.toPhone()==null?"":r.toPhone());var o="GiftCerOrderId="+i.giftCerOrderId()+"&GiftCerTransactionId="+i.giftCerTransactionId()+"&GiftCode="+i.giftCode()+"&From="+i.from()+"&Message="+i.message()+"&Phone="+f+"&Email="+u+"&TodayAsp="+i.todayAsp()+"&DeliveryDate="+i.deliveryDate()+"&PayAmount="+i.payAmount()+"&GetAmount="+i.getAmount()+"&GiftCerSendTypeId="+i.giftCerSendTypeId()+"&GiftCerImagesId="+i.giftCerImagesId()+"&GiftCerAccountId="+i.giftCerAccountId()+"&IsReceive="+i.isReceive()+"&domainName="+t.domainName(),s=new ObjUrl(cJsonEgiftCardUpdate),h=s.getUrlFromJson();passData=o;getJsonFromAjax(h,!ajax_async,ajax_cache,ajax_type_post,passData,ajax_timeout)},onCellClick:function(n){var i=n.data,r;n.rowType=="data"&&n.column.dataField=="resend"&&(r={msgType:"warning",msgTitle:"Do you want resend SMS/Email ["+i.giftCode()+"] ?"},swalMessage(r,function(){t.giftCode(i.giftCode());$("#"+cfrmGiftCerSearchDate).submit()}))}})}function DataSetupUsaEpaySearchDateViewModel(n){var t=this,i;i=isFireFox()?new Date:getDateJs(moment(n).format(moment_date_format_mmddyyyy));t.startDateBox=ko.observable({type:"date",pickerType:"calendar",value:i,displayFormat:"MM-dd-yyyy",onValueChanged:function(n){var i=moment(n.value).format(moment_date_format_mmddyyyy);t.startDate(i)}});t.endDateBox=ko.observable({type:"date",pickerType:"calendar",value:i,displayFormat:"MM-dd-yyyy",onValueChanged:function(n){var i=moment(n.value).format(moment_date_format_mmddyyyy);t.endDate(i)}});t.domainId=ko.observable("");t.startDate=ko.observable(moment(n).format(moment_date_format_mmddyyyy));t.endDate=ko.observable(moment(n).format(moment_date_format_mmddyyyy));t.data=ko.observableArray([]);t.dataDetail=ko.observableArray([]);t.dataGridUsaEpaySearchDate=ko.observable({dataSource:t.data,showColumnLines:!0,showRowLines:!0,showBorders:!0,hoverStateEnabled:!0,sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{dataField:"domainId",caption:"",width:80,alignment:"center",allowFiltering:!1,visible:!1},{dataField:"batchRefNum",caption:"#",alignment:"center",cssClass:"left"},{dataField:"date",caption:"Date",alignment:"center",cssClass:"left",sortOrder:"asc"},{dataField:"netAmount",caption:"Net Amount",alignment:"center",cssClass:"right"},{dataField:"saleAmount",caption:"Sale Amount",alignment:"center",cssClass:"right"},{dataField:"voidAmount",caption:"Void Amount",width:100,alignment:"center",cssClass:"right"},{dataField:"creditAmount",caption:"Credit Amount",width:100,alignment:"center",cssClass:"right"},{dataField:"active",caption:"",width:80,alignment:"center",allowFiltering:!1}],onCellPrepared:function(n){var i=n.column,r=n.value,t="";i.dataField==="active"&&(isEmpty(r)||(t="<span><i class='fa fa-list-alt'><\/i><\/span>",n.cellElement.html(t)))},onRowClick:function(){},onCellClick:function(n){var t=n.data,i;if(n.rowType=="data"&&n.column.dataField=="active"){isLoading(!0);vmViewIndex.setup.dataSetUpUsaEpaySearchDateModal.dataDetail([]);refreshGrid(cGridSetUpUsaEpaySearchDateDetail);const n=t.domainId()+"|"+t.batchRefNum();i=getObjFormAjax(cJsonSetUpUsaEpaySearchDateDetail,n);ko.mapping.fromJSON(i,{},vmViewIndex.setup.dataSetUpUsaEpaySearchDateModal.dataDetail);modalShow(cModalSetupUsaEpaySearchDateDetail);isLoading(!1)}}});t.dataGridUsaEpaySearchDateDetail=ko.observable({dataSource:t.dataDetail,showColumnLines:!0,showRowLines:!0,showBorders:!0,sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},filterRow:{visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{dataField:"accountHolder",caption:"Account Holder",alignment:"center",cssClass:"left"},{dataField:"cardNumber",caption:"Card Number",alignment:"center",cssClass:"left",sortOrder:"asc"},{dataField:"cardType",caption:"Card Type",alignment:"center",cssClass:"center"},{dataField:"amount",caption:"Amount",alignment:"center",cssClass:"right"},{dataField:"status",caption:"Status Code",alignment:"center",cssClass:"center"},],onCellPrepared:function(n){var r=n.column,t=n.value,i="";r.dataField==="status"&&(isEmpty(t)||(i=t=="S"?"<span class='text-success'>Settle<\/span>":t=="R"?"<span class='text-danger'>Refund<\/span>":t=="V"?"<span class='text-danger'>Void<\/span>":t.value,n.cellElement.html(i)))},onRowClick:function(){}})}function DataUpdateVersionViewModel(){var n=this;n.data=ko.observableArray([]);n.dataDomainUpdate=ko.observableArray([]);n.selectVersionValue=ko.observable("");n.storeVersion=new DevExpress.data.ArrayStore({data:[],key:"versionId"});n.clickUpdateVersion=function(){if(isEmpty(n.selectVersionValue()))swal(cSwal_Alert_Warning,cError_Version_Empty,cSwal_Icon_Warning);else{var t=[];ko.utils.arrayForEach(n.dataDomainUpdate(),function(n){t.push(n.domainId())});t.length>0?(addSpinButton(cModalUpdateVersion),sendUpdateVersionAutoUpdate(t)):swal(cSwal_Alert_Warning,cError_Domain_Version_Empty,cSwal_Icon_Warning)}};n.dxLookupVersion=ko.observable({dataSource:n.storeVersion,placeholder:"Please Select Version",displayExpr:"major",valueExpr:"versionId",value:n.selectVersionValue(),onSelectionChanged:function(t){n.dataDomainUpdate().length!=0&&n.dataDomainUpdate.removeAll();var i=t.selectedItem.major();n.selectVersionValue(i)}});n.dataGridUpdateVersion=ko.observable({onInitialized:function(n){dataGrid=n.component},dataSource:n.data,showColumnLines:!0,showRowLines:!1,showBorders:!0,hoverStateEnabled:!0,onInitialized:function(n){dataGrid=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(dataGrid.pageIndex()*dataGrid.pageSize()+t.rowIndex+1)}},{dataField:"domainDesc",caption:"Shop Name",alignment:"center"},{dataField:"domainVersion",caption:"Version",alignment:"center",calculateCellValue:function(t){var i=parseFloat(t.domainVersion()),r=parseFloat(n.selectVersionValue());return r>i?i+" => "+r:i}},{dataField:"time",caption:"",width:80,alignment:"center",calculateCellValue:function(){return"delete"}}],onCellPrepared:function(t){var i=t.column,u=t.value,r="";if(i.dataField=="time"&&(isEmpty(u)||(r="<span><i class='fa fa-trash fa-lg' style='color:red;'><\/i><\/span>",t.cellElement.html(r))),i.dataField=="domainVersion"&&t.displayValue!=undefined&&n.selectVersionValue()!=""){var f=parseFloat(n.selectVersionValue()),e=parseFloat(t.data.domainVersion()),o=f>e?!0:!1;o&&(t.cellElement.css("color","red"),n.dataDomainUpdate().push(t.data))}},onCellClick:function(n){var t=n.component,i=n.data;n.rowType=="data"&&n.value=="delete"&&t.deleteRow(n.rowIndex)},loadPanel:{enabled:!0,showPane:!1,text:""},pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30}})}function DataUpdateVersionDetailViewModel(){var n=this;n.data=ko.observableArray([]);n.domainId=ko.observable("");n.domainDesc=ko.observable("");n.domainVersion=ko.observable("");n.status=ko.observable("");n.clickCloseModal=function(){n.data().length>0&&(n.data([]),n.domainId(""),n.domainDesc(""),n.domainVersion(""),n.status(""))};n.checkColor=function(){var t=n.status();return t.includes(cProcessStatusFailed)?"red":t==cProcessStatusFinished?"green":"#FF9800"};n.dataGridUpdateVersionDetail=ko.observable({onInitialized:function(n){dataGrid=n.component},dataSource:n.data,showColumnLines:!0,showRowLines:!1,showBorders:!0,hoverStateEnabled:!0,onInitialized:function(n){dataGrid=n.component},scrolling:{mode:"virtual"},paging:{pageSize:100},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(dataGrid.pageIndex()*dataGrid.pageSize()+t.data.processId())}},{dataField:"sorting",caption:"#",groupIndex:0,autoExpandGroup:!1,calculateCellValue:function(n){return n.sorting()+" - Name: "+n.name()}},{dataField:"processName",caption:"Process",alignment:"left"},{dataField:"status",caption:"Status",alignment:"center"},],onCellPrepared:function(n){var t=n.data,i="";n.rowType==="data"&&n.column.dataField==="status"&&(i=t.status()==cProcessStatusInit?'<span style="color:green;"><i class="fa fa-check-circle"><\/i> Start<\/span>':t.status()==cProcessStatusStart?t.isRollback()?'<div class="progress-bar-rollback"> <span class="bar"> <span class="progress-rollback"><\/span> <\/span> <\/div>':'<div class="progress-bar"> <span class="bar"> <span class="progress"><\/span> <\/span> <\/div>':t.status()==cProcessStatusCompleted?t.isRollback()?'<span style="color:green;"><i class="fa fa-check-circle"><\/i> Rollback Completed<\/span>':'<span style="color:green;"><i class="fa fa-check-circle"><\/i> Completed<\/span>':t.status()==cProcessStatusFinished?'<span style="color:green;"><i class="fa fa-check-circle"><\/i> Finished<\/span>':t.status()==cProcessStatusFailed?'<span style="color:red;">Fail <i class="fa fa-exclamation-circle"><\/i><\/span>':t.status()==cProcessStatusWaiting?'<span style="color:#FF9800;">In progress...<\/span>':t.status()==cProcessStatusRollback?'<span style="color:#FF9800;">Rollback In progress...<\/span>':"",n.cellElement.html(i))}})}function DataProcessUpdateVersionDetailViewModel(n,t,i,r,u){var f=this;f.id=ko.observable(isEmpty(n)?"":n.id());f.name=ko.observable(isEmpty(n)?"":n.name());f.processName=ko.observable(isEmpty(i)?"":i.name);f.processId=ko.observable(isEmpty(i)?"":i.id);f.status=ko.observable(isEmpty(r)?"":r);f.avgExecutionTime=ko.observable(isEmpty(t)?"":t.avgExecutionTime());f.isRollback=ko.observable(isEmpty(t)?!1:t.isRollback());f.message=ko.observable(isEmpty(t)?"":t.message());f.sorting=ko.observable(isEmpty(u)?"":u)}function DataSettingSvnViewModel(){var n=this;n.urlRepository=ko.observable("");n.username=ko.observable("");n.password=ko.observable("");n.autoUpdatePath=ko.observable("");n.pos=ko.observable("");n.tablet=ko.observable("");n.webReport=ko.observable("")}function DataDeliveryBillingViewModel(){var n=this;n.shopName=ko.observable("");n.shopStreet=ko.observable("");n.period=ko.observable("");n.countCommission=ko.observable(0);n.countTip=ko.observable(0);n.sumCommission=ko.observable(0);n.sumTip=ko.observable(0);n.totalAmount=ko.observable(0);n.selectMonth=ko.observable(new Date);n.deliveryBillingDetail=ko.observableArray([]);n.dataObj=ko.observable(null);n.dateBoxMonth=ko.observable({type:"date",width:250,value:n.selectMonth(),displayFormat:"monthAndYear",minZoomLevel:"century",maxZoomLevel:"year",onValueChanged:function(t){n.selectMonth(t.value);t.element.context.id=="selectMonthHeader"&&(isLoading(!0),setTimeout(function(){var i=moment(t.value).format("L"),r=JSON.parse(getDataDeliveryBillingObjFormAjax(cJsonGetDataDeliveryBilling,n.dataObj().domainId(),n.dataObj().domainName(),i));DataDeliveryBillingModalViewModel(r);isLoading(!1)},0))}});n.dataGridDeliveryBilling=ko.observable({dataSource:n.deliveryBillingDetail,showBorders:!1,showColumnHeader:!1,showColumnLines:!1,showRowLines:!0,visible:!0,hoverStateEnabled:!0,columnAutoWidth:!0,onInitialized:function(n){dataGrid=n.component},columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(dataGrid.pageIndex()*dataGrid.pageSize()+t.rowIndex+1)}},{dataField:"ticketId",caption:"Order ID",alignment:"center",width:120},{dataField:"ticketDateTime",caption:"Date/Time",alignment:"left",width:150},{dataField:"customerName",caption:"Customer Name",alignment:"left",width:140},{dataField:"total",caption:"Total",dataType:"number",alignment:"right",cssClass:"right",format:"currency",precision:2,width:70},{dataField:"commission",caption:"Commission",dataType:"number",alignment:"right",cssClass:"right",format:"currency",precision:2,width:100},{dataField:"dasherTip",caption:"Dasher Tip",dataType:"number",alignment:"right",cssClass:"right",format:"currency",precision:2,width:90},{dataField:"totalCharge",caption:"Total Charge",dataType:"number",alignment:"right",cssClass:"right",format:"currency",precision:2,width:100}],pager:{showPageSizeSelector:!0,allowedPageSizes:[30,60,90],showInfo:!1,visible:!0},paging:{enabled:!0,pageIndex:0,pageSize:30},loadPanel:{enabled:!0,showPane:!1,text:""},onContentReady:function(){$("#gridDeliveryBilling .dx-scrollable").dxScrollable({showScrollbar:"always"})}});n.clearDataModal=function(){n.shopName("");n.shopStreet("");n.period("");n.countCommission(0);n.countTip(0);n.sumCommission(0);n.sumTip(0);n.totalAmount(0);n.selectMonth(new Date);n.deliveryBillingDetail([]);n.dataObj(null);vmViewIndex.deliveryBilling.dataSendEmailModal.data([])};n.clickSendEmail=function(){addSpinButton(cModalDeliveryBilling);addSpinButton(cModalDeliveryBillingSendEmail);var t=[],i=0,r=moment(n.selectMonth()).format("L");isEmpty(n.dataObj())?(ko.utils.arrayForEach(vmViewIndex.deliveryBilling.dataSendEmailModal.data(),function(n){t.push(n.domainName())}),i=_.first(vmViewIndex.deliveryBilling.dataSendEmailModal.data()).dispatchTypeId()):(t.push(n.dataObj().domainName()),i=n.dataObj().dispatchTypeId());var u=new ObjUrl(cfrmDeliveryBillingSendEmail),f=u.getUrlSubmitForm(),e={listDomainName:t,dateSelect:r,dispatchType:i};$.ajax({url:f,async:ajax_async,cache:ajax_cache,type:ajax_type_post,data:e,timeout:ajax_timeout}).done(function(n){var t,i;removeSpinButton(cModalDeliveryBilling);removeSpinButton(cModalDeliveryBillingSendEmail);n.status&&(t=$("#"+cGridDeliveryBilling).dxDataGrid("instance"),t.clearSelection(),modalHide(cModalDeliveryBilling),modalHide(cModalDeliveryBillingSendEmail));i=new ObjAlert(cfrmDeliveryBillingSendEmail,n.message,n.status);i.getAlert()}).fail(function(){removeSpinButton(cModalDeliveryBilling);removeSpinButton(cModalDeliveryBillingSendEmail);swal(cSwal_Alert_Error,cError_Fail_TimeOut,cSwal_Icon_Error)})}}function DataDeliveryBillingModalViewModel(n){var t=vmViewIndex.deliveryBilling.dataModal;t.shopName(n.shopName);t.shopStreet(n.shopStreet);t.period(n.period);t.countCommission(n.countCommission);t.countTip(n.countTip);t.sumCommission(n.sumCommission);t.sumTip(n.sumTip);t.totalAmount(rountTwo(t.sumCommission()+t.sumTip()));t.selectMonth(new Date(n.currentDateTime));ko.mapping.fromJS(n.deliveryBillingDetail,{},t.deliveryBillingDetail)}function DataDeliveryBillingSendEmailViewModel(){var n=this;n.data=ko.observableArray([]);n.dataLength=ko.observable(0);n.dataGridSendEmail=ko.observable({dataSource:n.data,showColumnLines:!0,showRowLines:!0,showBorders:!0,editing:{allowDeleting:!0},hoverStateEnabled:!0,sorting:{mode:"multiple"},paging:{pageSize:15},pager:{showPageSizeSelector:!0,allowedPageSizes:[15,30,60,90],showInfo:!0,showNavigationButtons:!0,showPageSizeSelector:!0,visible:!0},allowColumnReordering:!0,columnAutoWidth:!0,columns:[{caption:"#",width:40,alignment:"center",cellTemplate:function(n,t){n.text(dataGrid.pageIndex()*dataGrid.pageSize()+t.rowIndex+1)}},{dataField:"domainDesc",caption:"Shop Name",alignment:"center",cssClass:"left",width:400},{dataField:"dispatchTypeId",caption:"Delivery By",alignment:"center",cssClass:"left"},],onCellPrepared:function(t){var u=t.column,r=t.value,i="";u.dataField==="dispatchTypeId"?isEmpty(r)||(r==cDispatchType_Deliverect?i="<span><img src='/Content/Images/deliverect_logo.png'><\/span>":r==cDispatchType_DoorDash&&(i="<span><img src='/Content/Images/doordash_logo.png'><\/span>"),t.cellElement.html(i)):u.type==="buttons"&&u.dataField===undefined&&r!==undefined&&(i="<span><i class='fa fa-trash fa-lg' style='color:red;'><\/i><\/span>",t.cellElement.html(i));n.dataLength(n.data().length)},onCellClick:function(n){var i=n.component,t=n.column;n.rowType==="data"&&t.type==="buttons"&&t.dataField===undefined&&i.deleteRow(n.rowIndex)}})}